import { MessageEvent, ErrorEvent } from './websocket'
<<<<<<< HEAD
import Dispatcher from './dispatcher'
=======
>>>>>>> ec2fe0ed0a0234e021dd53c74b9bd62ec07f1f0f

import {
  EventTarget,
  Event,
  EventListenerOptions,
  AddEventListenerOptions,
  EventListenerOrEventListenerObject
} from './patch'

interface EventSourceEventMap {
  error: ErrorEvent
  message: MessageEvent
  open: Event
}

interface EventSource extends EventTarget {
  close(): void
  readonly CLOSED: 2
  readonly CONNECTING: 0
  readonly OPEN: 1
  onerror: (this: EventSource, ev: ErrorEvent) => any
  onmessage: (this: EventSource, ev: MessageEvent) => any
  onopen: (this: EventSource, ev: Event) => any
  readonly readyState: 0 | 1 | 2
  readonly url: string
  readonly withCredentials: boolean

  addEventListener<K extends keyof EventSourceEventMap>(
    type: K,
    listener: (this: EventSource, ev: EventSourceEventMap[K]) => any,
    options?: boolean | AddEventListenerOptions
  ): void
  addEventListener(
    type: string,
    listener: EventListenerOrEventListenerObject,
    options?: boolean | AddEventListenerOptions
  ): void
  removeEventListener<K extends keyof EventSourceEventMap>(
    type: K,
    listener: (this: EventSource, ev: EventSourceEventMap[K]) => any,
    options?: boolean | EventListenerOptions
  ): void
  removeEventListener(
    type: string,
    listener: EventListenerOrEventListenerObject,
    options?: boolean | EventListenerOptions
  ): void
}

export declare const EventSource: {
  prototype: EventSource
<<<<<<< HEAD
  new (url: string | URL, init?: EventSourceInit): EventSource
=======
  new (url: string | URL, init: EventSourceInit): EventSource
>>>>>>> ec2fe0ed0a0234e021dd53c74b9bd62ec07f1f0f
  readonly CLOSED: 2
  readonly CONNECTING: 0
  readonly OPEN: 1
}

interface EventSourceInit {
<<<<<<< HEAD
  withCredentials?: boolean,
  dispatcher?: Dispatcher
=======
  withCredentials?: boolean
>>>>>>> ec2fe0ed0a0234e021dd53c74b9bd62ec07f1f0f
}
