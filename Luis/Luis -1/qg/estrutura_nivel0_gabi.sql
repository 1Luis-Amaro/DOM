--
-- Geração de relatório de Estrutura no nível 0. Filtro por itens acabados de GVT e SUM não Inativos e Obsoletos.
--
--


--WITH cteMenuNivel(id,Nome,Nivel,NomeCompleto)
--AS
--(
--    -- Ancora
--    SELECT id,Nome,1 AS 'Nivel',CAST(Nome AS VARCHAR(255)) AS 'NomeCompleto' 
--    FROM tbMenu WHERE idPai IS NULL
--    
--    UNION ALL
    
--    -- Parte RECURSIVA
--    SELECT 
--        m.id,m.Nome,c.Nivel + 1 AS 'Nivel',
--        CAST((c.NomeCompleto + '/' + m.Nome) AS VARCHAR(255)) 'NomeCompleto' 
--    FROM tbMenu m INNER JOIN cteMenuNivel c ON m.idPai = c.id
    
--)
--SELECT Nivel,NomeCompleto FROM cteMenuNivel




WITH cteMenuNivel(segment1,inventory_item_id,qty, formula_id, recipe_id, organization_id, Nivel)
AS
(
    -- Ancora
    SELECT msi.segment1,
           fmd.inventory_item_id,
           CASE
              WHEN msip.planning_make_buy_code  = 1 THEN
                 1
              WHEN fmd.scale_type = 0 THEN
                 (fmd.qty / fm.qty) / vr.std_qty
              WHEN fmd.scale_type = 1 THEN
                 (fmd.qty / fm.qty)
              ELSE
                 (fmd.qty / fm.qty)
           END qty ,
           fmd.formula_id,
           gr.recipe_id,
           fmd.organization_id,
           0 as Nivel
      FROM apps.fm_form_mst_b fms,
           apps.fm_matl_dtl   fm,
           apps.fm_matl_dtl   fmd,
           apps.gmd_recipes_b gr,
           apps.gmd_recipe_validity_rules vr,
           apps.mtl_system_items_b msi,
           apps.mtl_system_items_b msip
     WHERE fmd.line_type              = -1                   AND           
           fmd.formula_id             = fm.formula_id        AND
           fmd.organization_id        = fm.organization_id   AND
--           
           /**** performance ****/
           vr.preference                  = 1               AND   
           vr.delete_mark                 = 0               AND   
           vr.recipe_use                  = 0               AND --Custos 
           vr.validity_rule_status       in (700,900)       AND 
           vr.recipe_id                   = gr.recipe_id    AND
           vr.start_date                 <= sysdate         AND
           vr.end_date                   is NULL            AND           
           /**** performance ****/
--           
           gr.recipe_id                 = (select max(gr1.recipe_id)
                                             FROM apps.gmd_recipes_b gr1,
                                                  apps.gmd_recipe_validity_rules vr1
                                            WHERE /**** Performance ****/
                                                  vr1.delete_mark           = 0                  AND
                                                  vr1.preference            = 1                  AND      
                                                  vr1.recipe_use            = 0 /*Custos*/      AND
                                                  vr1.validity_rule_status in (700,900)          AND
                                                  vr1.start_date           <= sysdate            AND
                                                  vr1.end_date             is null               AND
                                                  vr1.organization_id       = fm.organization_id AND
                                                  vr1.recipe_id             = gr1.recipe_id      AND
                                                  /**** Performance ****/
                                                  gr1.recipe_status        in (700,900)          AND
                                                  gr1.formula_id            = fm.formula_id) AND
--                                                  
           gr.recipe_status            in (700,900)             AND
           gr.formula_id                = fm.formula_id         AND
--           
           NVL(fms.formula_class,'SM') <> 'TING-PMC'            AND
           fms.formula_id               = fm.formula_id         AND
           fm.line_type                 = 1                     AND
           fm.inventory_item_id         = msi.inventory_item_id AND
           fm.organization_id           = msi.organization_id   AND
           msip.inventory_item_id       = fmd.inventory_item_id AND
           msip.organization_id         = msi.organization_id   AND
           --MSI.SEGMENT1 = 'BP-01.01'
           --
           msi.organization_id         IN (92)               AND
         --  msi.segment1 = '1501.01' and
          -- msi.item_type             LIKE 'ACA%'                
           --msi.inventory_item_status_code NOT IN ('Inactive','Obsoleto') AND
           --msi.segment1 in ('ZM463.01')
           --
           --msi.segment1 = '8201144982.99' --'TOEA-6247Z.79' --'8201144996.99' --'8201540330.99' --'TOEA-6247Z.79'
           --msi.inventory_item_id        = 2701
            msi.segment1 in ('26800018L',
'26800019L',
'26800020L',
'26800021L',
'26800032L',
'26800034L',
'26800083L',
'26800104L',
'5900060L',
'5900063L',
'5900064L',
'5900082L',
'5900083L',
'5900099L',
'5900122L',
'5900128L',
'5900131L',
'6030003L',
'6030005L',
'6030007L',
'6030082L',
'6030100L',
'6030127L',
'6047',
'2690102L',
'2690114L',
'269306L',
'269554L',
'279795L',
'283292L',
'288955L',
'288956L',
'299378L',
'299793L',
'312614L',
'316067L',
'317953L',
'318046L',
'318204L',
'318205L',
'318709L',
'3290037L',
'3290039L',
'337099L',
'3500029L',
'3500057L',
'357538',
'357539',
'357661L',
'358779L',
'358780L',
'358781L',
'359006L',
'359007L',
'359008L',
'359009L',
'366500L',
'373835L',
'373836L',
'390110BR',
'390203BR',
'390343BR',
'390509BR',
'390607BR',
'3920055L',
'4100003L',
'4100004L',
'4100006L',
'4100011L',
'4100013L',
'4100014L',
'4100032L',
'4100034L',
'4100048L',
'456000145L',
'45600059L',
'4560006L',
'4560081L',
'4560124L',
'4560125L',
'4560126L',
'5200026L',
'5200120L',
'5200128L',
'5200134L',
'543602',
'5500005L',
'5500006L',
'5500007L',
'55000146L',
'5500019L',
'5500024L',
'5500034L',
'5500048L',
'5500059L',
'5500074L',
'5500080L',
'5500081L',
'5500083L',
'5500088L',
'5500095L',
'5500109L',
'5500121L',
'5500124L',
'5500133L',
'5500135L',
'5500140L',
'5500143L',
'5510032L',
'5510115L',
'5900003L',
'5900004L',
'5900006L',
'5900007L',
'5900019L',
'5900032L',
'5900048L',
'5900049L',
'26800008L',
'26800010L',
'26800011L',
'26800012L',
'26800013L',
'26800014L',
'26800015L',
'26800016L',
'F366',
'F369',
'F371',
'F372',
'F373',
'F385',
'F390',
'F391',
'INTPMC-3131',
'INTPMC-341',
'INTPMC-3610',
'INTPMC-403',
'INTPMC-4035',
'INTPMC-4073',
'INTPMC-4089',
'INTPMC-602',
'INTPMC-604',
'INTPMC-606',
'INTPMC-6069',
'INTPMC-6102',
'INTPMC-6113',
'INTPMC-6130',
'INTPMC-7045',
'INTPMC-706',
'F392',
'F420-A0319',
'F640-A5222',
'F912-A0520',
'FBR018',
'FBR262',
'FBR264',
'FBR323',
'FBR324',
'FBR326',
'FBR328',
'FBR331',
'FBR332',
'FBR333',
'FBR334',
'FBR335',
'FBR337',
'FBR338',
'FBR339',
'FBR397',
'FBR427',
'FBR450',
'FBR451',
'FBR454',
'FBR517',
'FBR519',
'FBR522',
'FBR523',
'FBR524',
'FBR525',
'FBR531',
'FBR535',
'FIBB-00044',
'FIBB-00045',
'FIBD-00041',
'FIBE-00001',
'FIBE-00002',
'FIHA-00001',
'FIHA-00002',
'FIHA-00003',
'FIHA-00004',
'FIHB-00001',
'FIHB-00002',
'FIHB-00003',
'FIHB-00004',
'FIHC-00001',
'FIHC-00003',
'FIHC-00004',
'FIHC-00005',
'FIHC-00006',
'FIPC-00002',
'FIPE-00001',
'FIPE-00002',
'FIPE-00003',
'FIPE-00004',
'FISA-00001',
'FISA-00002',
'FISA-00003',
'FISA-00004',
'FISB-00003',
'FIVC-00001',
'FK37',
'GEL-8156',
'GEL-8158',
'GLT0676',
'GMBB-00046',
'GMBD-00031',
'GMBD-00035',
'HEAC',
'HSL14004BR',
'HSL14007BR',
'HSL14008BR',
'HSL14010BR',
'HSL14011BR',
'HSL917951BR',
'HSL917954BR',
'HSL931207BR',
'HSL931374BR',
'HSL932371BR',
'HSL932767BR',
'HSL933850BR',
'HSL933851BR',
'I-W533C998',
'IN511',
'INT7940',
'INTIG4000',
'INTPMC-103',
'INTPMC-1041',
'INTPMC-202',
'INTPMC-302',
'INTPMC-305',
'INTPMC-3082',
'INTPMC-3083',
'F342',
'F343',
'F351',
'F359',
'F361',
'F362',
'F363',
'F365',
'PPG2658-602A',
'PPG2678-401A',
'PPG2678-501A',
'PPG2678-801A',
'PPG2679-301A',
'PPG2680-001A',
'PPG2858-006A',
'PPG2858-012A',
'PPG2858-012B',
'PPG2858-013A',
'PPG2858-015A',
'PPG2858-016A',
'PPG2858-901A',
'PPG2952-801A',
'PPG2952-803A',
'PPG2952-804A',
'PCT1G.7010',
'PCT1K-1117',
'PCT1K-8030',
'PCT1K-9009',
'PCT1K.10054DB',
'PCT1K.1031DB',
'PCT1K.1038',
'PCT1K.1043',
'PCT1N-1131',
'PCT1N-1141',
'PCT1N-1823G',
'PCT1N-1823T',
'PCT1N-1890F',
'PCT1N-6038',
'PCT1N-8024',
'PCT1N-8038',
'PCT1N.0060',
'PCT1N.0069',
'PCT1N.10018DB',
'PCT1N.10027',
'PCT1N.10047',
'PCT1N.10087',
'PCT1N.10088',
'PCT1N.10089',
'PCT1N.10091',
'PCT1N.10098DB',
'PCT1N.10123DB',
'PCT1N.1034',
'PCT1N.1035',
'PCT1N.1065',
'PCT1N.1822',
'PCT1N.1823',
'PCT1N.1890',
'PCT1N.1890T',
'PCT1N.1891',
'PCT1N.1892',
'PCT1N.6003',
'PCT1N.8000',
'PCT1N.8008',
'PCT1P.10039',
'PCT1P.10044',
'PCT1P.9001',
'PCT1P.9007',
'PCT1S.10058',
'PCT1T.10055',
'PCT1T.10056',
'PCT1T.10126',
'PCT1T.2016',
'PCT1T.2023',
'PCT1T.2034',
'PCT1T.2075',
'PCT1T.2091',
'PCT9G.1796',
'PE-AT.38',
'PE-AT.41',
'PE-AT.51',
'PE-AT.60',
'PE-AT.61',
'PEPB-00001',
'PLPP-00017',
'PP6836',
'PPCT-7002',
'PPG0122-006A',
'PPG0122-007A',
'PPG0122-010A',
'PPG0122-012A',
'PPG0122-201A',
'PPG0122-801A',
'PPG2004-398A',
'PPG2004-401A',
'PPG2004-402A',
'PPG2004-846A',
'PPG2004-899A',
'PPG2066-813A',
'PPG2066-815A',
'PPG2066-818A',
'PPG2066-819A',
'PPG2066-892A',
'PPG2092-683A',
'PPG2092-684A',
'PPG2092-821A',
'PPG2092-823A',
'PPG2092-824A',
'PPG2092-899A',
'PPG2315-808A',
'PPG2315-809A',
'PPG2315-810A',
'PPG2463-303A',
'PPG2463-607A',
'PPG2463-801A',
'PPG2463-803A',
'PPG2463-806A',
'PPG2534-601A',
'PPG2541-302A',
'PPG2541-303A',
'PPG2541-305A',
'PPG2613-201A',
'PPG2613-203A',
'PPG2613-401A',
'PPG2613-810A',
'PPG2657-810A',
'PPG2657-812A',
'PPG2658-023A',
'PPG2658-102A',
'PCF7N.1056',
'APBB-00004',
'PCF7G.7009',
'W9747',
'AK2-019L',
'W9738',
'LT0082SSA',
'CF700HNM',
'FBR262.INT',
'PPG2289-860B',
'TF714',
'TF1001',
'FIHB-00005',
'0480123L',
'0560126L',
'0560129L',
'102670L',
'1090034L',
'1090070L',
'115352L',
'119507L',
'240476L',
'240699L',
'242083L',
'246840L',
'247810L',
'249232L',
'249237L',
'250780L',
'250781L',
'250783L',
'250792L',
'252553L',
'254174L',
'254175L',
'267449L',
'26770010L',
'26770018L',
'26770034L',
'26770143L',
'26800003L',
'26800004L',
'26800005L',
'26800006L',
'12020079L',
'121186L',
'128821L',
'136774L',
'136775L',
'137272L',
'141102L',
'141347L',
'142014L',
'144493L',
'145031L',
'146095L',
'149922L',
'149924L',
'153250L',
'153975L',
'153979L',
'153983L',
'154011L',
'154017L',
'154019L',
'154020L',
'154021L',
'154022L',
'154023L',
'155822L',
'157367L',
'1580034L',
'1580073L',
'159337L',
'1600078L',
'160983L',
'165054L',
'16610073L',
'195037L',
'202390L',
'204608L',
'204618L',
'210339L',
'211282L',
'218773L',
'219235L',
'219261L',
'219267L',
'21980076L',
'220295L',
'220297L',
'224095L',
'224096L',
'231302L',
'231921L',
'237059L',
'238754L',
'238847L',
'239969L',
'240471L',
'0007944L',
'0280095L',
'0280105L',
'0280107L',
'0280116L',
'314',
'321',
'D832',
'D837',
'D839',
'D841',
'D851',
'D863',
'D868',
'D895',
'F311',
'F312',
'F313',
'F314',
'F3140',
'F315',
'F317',
'F318',
'F319',
'F320',
'F321',
'F323',
'F324',
'F325',
'F335',
'F341',
'D943',
'D944',
'D945',
'D946',
'D952',
'D953',
'D955',
'D956',
'D958',
'D959',
'D966',
'D967',
'D970',
'D977',
'D978',
'D979',
'D980',
'D981',
'D983',
'D985',
'DC3000',
'DC4000',
'DE-117',
'DE-122',
'DE-123',
'DE-128',
'DE-129',
'DE-131',
'DUL1800',
'DUL606',
'DUL610',
'DUL611',
'DUL613',
'DUL615',
'DUL616',
'DUL617',
'DUL618',
'DUL620',
'DUL624',
'DUL625',
'DUL626',
'DUL629',
'DUL632',
'DUL633',
'DUL634',
'DUL636',
'DUL638',
'DUL639',
'DUL640',
'DUL641',
'DUL642',
'DUL643',
'DUL645',
'DUL646',
'DUL647',
'DUL648',
'DUL651',
'DUL652',
'DUL653',
'DUL654',
'DUL658',
'DUL659',
'DUL671',
'DUL672',
'DUL673',
'DUL674',
'DUL675',
'DUL690',
'DUL692',
'DUL698',
'DUL702',
'DUL703',
'DUL9291',
'E-0002',
'E-0004',
'E-0005',
'E-0008',
'E-0010',
'E-0011',
'E-6247',
'E-6356C',
'E-6446',
'E6176',
'E6355',
'E6433',
'E6445',
'EDADDWETT',
'F300',
'F301',
'F302',
'F304',
'F305',
'F306',
'F308',
'F309',
'F310',
'D789',
'D793',
'D794',
'D797',
'D800',
'D802',
'D803',
'D807',
'PCF7G.0015',
'PCF7G.0038',
'PCF7G.0038B',
'PCF7G.0038L1',
'PCF7G.0087',
'PCF7G.0087S',
'PCF7G.1069DB',
'PCT1G.10005',
'PCT1G.10006',
'PCT1G.10007',
'PCT1G.10009',
'PCT1G.10010',
'PCT1G.10022',
'PCT1G.10023DB',
'PCT1G.10074',
'PCT1G.10082',
'PCT1G.10125',
'PCT1G.1064',
'PCT1G.1084',
'PCT1G.1791',
'PCT1G.3017',
'PCT1G.4514',
'PCT1G.4522',
'PCF7G.1411',
'PCF7G.1440',
'PCF7G.1476',
'PCF7G.1501',
'PCF7G.1513',
'PCF7G.3013',
'PCF7G.4015',
'PCF7G.4016',
'PCF7G.4517',
'PCF7G.5031DB',
'PCF7G.90170',
'PCF7K.0030',
'PCF7K.1050',
'PCF7K.2102',
'PCF7K.2192',
'PCF7N-1149',
'PCF7N-8035',
'PCF7N.0068DB',
'PCF7N.1063',
'PCF7N.1390',
'PCF7N.1391',
'PCF7N.1391T',
'PCF7N.1692',
'PCF7N.8020',
'PCF7N.90150DB',
'PCF7P-9010',
'PCF7S.2191',
'PCF7S.90148',
'PCF7T-1128',
'PCF7T-1146',
'PCF7T-3035',
'PCF7T.1059',
'PCF7T.2051',
'PCF7T.2065',
'PCF7T.2079',
'PCF7T.2224',
'PCF7T.2275',
'PCF7T.90125',
'PCM1G-8029',
'PCM1G.1215',
'PCM1N.8014',
'PCM1N.95074',
'PCM2N.96002DB',
'PCM3N-6042',
'PCM3N-96010',
'PCM3N.96010DB',
'PCS1K-1139',
'PCS1N-1125',
'PCS1N-1138',
'PCS1N-1143',
'PCS1N-1147',
'PCS1N-1150',
'PCS1N-3034',
'PCS1N-8040',
'PCS1N-8042',
'PCS1N-8043',
'PCS1N-8044',
'PCS1N.1036',
'PCS1N.1077',
'PCS1N.3015',
'PCS1N.8006',
'PCT1G-0110',
'PCT1G-0113',
'PCT1G-0117',
'PCT1G-1064B',
'PCT1G-1084B',
'PCT1G-1099',
'PCT1G-1100',
'PCT1G-1142',
'PCT1G-1144',
'PCT1G-3017B',
'PCT1G-3021',
'PCT1G-3032',
'PCT1G-3033',
'PCT1G-4522B',
'PCT1G-4528',
'PCT1G-4531',
'PCT1G-6033',
'PCT1G-6041',
'PCT1G-7010B',
'PCT1G-8023',
'PCT1G-8033',
'PCT1G.10000',
'PCT1G.10002',
'PCT1G.10003',
'PCF7G-0102',
'PCF7G-0108',
'PCF7G-0109',
'PCF7G-0116',
'PCF7G-0118',
'PCF7G-0119',
'PCF7G-1148',
'PCF7G-2043',
'PCF7T.1033',
'GEL-9892',
'TF804',
'APBC-00010',
'APBC-00011',
'IVSA-00011',
'IVTD-00007',
'PCT1G-4533',
'TF816',
'TF019',
'TF718',
'TF803',
'AT285-112L',
'AT285-BL',
'LT13014SSA',
'PCF7G.90134',
'FIBB-00046',
'TF730',
'WE-93-7263',
'CF700HN',
'CS100',
'AT385-147L',
'AT385-081L',
'VWPC-00010',
'FIHC-00007',
'APBB-00007',
'VWPC-00013',
'APBB-00006',
'FIHC-00008',
'VWPC-00011',
'VWPC-00012',
'PCF4N-9996',
'VWBC-00005',
'XX284177BR',
'VWSB-00003',
'PALA-00159',
'WO5500004L',
'FBR455',
'PPG4681-802A',
'LT0210WIO.57',
'PCS1N-1140',
'PCF7P.1041',
'APBB-00003',
'APBD-00001',
'APBD-00005',
'APBD-00006',
'APBD-00007',
'APBB-00009',
'TF905',
'LT0004SSA',
'TF017',
'TOHA-1K1WS',
'TOHA-1G2WS',
'LT15017SSO',
'LT13030SSA',
'PCF7P-1157',
'OM464',
'5500011L',
'NIBB-00004',
'APSA-00001',
'LT0084SSA',
'LT0083SSA',
'R00890367',
'146096L',
'390822',
'PCF7K.8013DB',
'SPU76795',
'TF1001P',
'FBR536',
'R56813162',
'MBTB-00021',
'PCF7G.5037',
'254109L',
'WOCS100',
'PCF7G-0121',
'REBD-00001',
'REBC-00001',
'RCHC-00003',
'CM-073A',
'FBR541',
'PCF7G.0038L3',
'PCF7P-7015',
'390340',
'FIBC-00015',
'IVTD-00064',
'IVTD-00065',
'IVTB-00064',
'LT16072SSA',
'LT16073SSA',
'FBR532',
'FBR543',
'PPG5079-301A',
'LT5717SDD',
'TF329',
'PHC',
'OM469',
'OM463',
'OM413',
'MBBB-00001',
'FITB-00002',
'FIPB-00002',
'APBC-00002',
'PCT1G-8048',
'PPG2658-201A',
'LG4983SSO',
'OM414',
'OM415',
'OM416',
'OM403',
'CF700HNR2',
'5500152L',
'IVTD-00047',
'OM405',
'WOLT13003SSA',
'LT16070SSA',
'LT16071SSA',
'PCF7K-7017',
'PCF7K-1155',
'FIVB-00002',
'FA841',
'FBR545',
'FIPB-00003',
'4100081L',
'323232L',
'NIVA-00004',
'LT0403SSA',
'PCF7G.0038RC',
'APSA-00002',
'PCF9G-5050',
'PPG5078-805A',
'324217L',
'320756L',
'PPG2658-901A',
'PCF7N.8012',
'PCF7G.5031',
'NIHA-00003',
'OM418',
'OM402',
'OM560',
'SPM76569',
'PCF7G.6020',
'LT13034SSA',
'LT13033SSA',
'LT15090SSA',
'PCT1G-4023',
'LT15033SSA',
'LT15032SSA',
'LT15007SSA',
'PPG2541-301A',
'TOVA-070RP',
'PCF7G.5035',
'PPG2613-204A',
'IVTD-00053',
'PCF7P-1152',
'AT385HS-154L',
'VEIC-516M',
'AT285-0004L',
'UT29',
'IVTD-00020',
'IVTD-00036',
'LT0450SSA',
'PCF7G.6021',
'MBTD-00021',
'P425-987',
'FBR701',
'XPM61419S',
'XPH80002NA',
'XPS90030',
'PCT1G.4516',
'APBD-00009',
'FBR800',
'AK22-BL',
'AK2-154L',
'PCT1N-0122',
'BMSB-00002',
'BMBE-00001',
'IVTD-00052',
'CA682JD',
'TF739',
'TF135',
'LT0325SSA',
'LT0326SSA',
'PPG4681-603',
'LT0324SSA',
'NPX5095BR',
'ADJ-001',
'PCS1N-1171',
'REVA-00003',
'VWHC-00007',
'VWHC-00008',
'PCS1N-1172',
'PCS1N-1173',
'PPG9201-813',
'APBD-00004',
'PCT1G.6022',
'IVTD-00067',
'APTD-00001',
'LT0085SSA',
'LT5729SDD',
'LT15019SSA',
'IVTB-00039',
'FISA-00007',
'IVTD-00041',
'SPM76570',
'SPM76490',
'SPM76495',
'SPM76496',
'APTD-00004',
'AT385HS-081L',
'CMPP3700BR',
'APTD-00003',
'ZBADDLPH',
'ZBADDED',
'IVTD-00058',
'IVTD-00040',
'CP587A',
'PPG4635-801A',
'LT14230SSA',
'PALA-00076',
'AK2-0156L',
'AT385HS-040L',
'W7911',
'5500032L',
'XB14030',
'8800004L',
'8800032L',
'IVTD-00054',
'PPG2092-825A',
'FIBD-00036',
'PCF7K-1156',
'267438L',
'5500104L',
'267439L',
'FIBB-00034',
'FIBD-00008',
'PCF7K-1158',
'RCHC-00004',
'REHA-00014',
'LG0002SSA',
'LT14231SSA',
'APTD-00006',
'319092L',
'319091L',
'FIBB-00031',
'FIBD-00001',
'FIBD-00024',
'FIBB-00047',
'FIBB-00022',
'PPG2658-301A',
'ZBCTRL1',
'ZBCTRL3',
'ZBBUFFM',
'284008BR',
'ZBRA',
'CFKF',
'W7917',
'W9714',
'MEPE-00002',
'MEPE-00003',
'MEHC-00001',
'MEHA-00001',
'MEHA-00002',
'MEHA-00003',
'CKCA',
'MEPE-00001',
'ZBCTRL5',
'CK166MD',
'ZBZC',
'TOZA-1G2RS',
'MWTD-00001',
'MWSA-00001',
'MWSB-00001',
'APBD-00010',
'APBB-00012',
'APBC-00012',
'APBB-00013',
'IVTB-00053',
'NIHC-00006')
 or
msi.segment1 in(
'TOZA-1K1RS',
'HOBB-830MS',
'HOBD-881SS',
'HOBC-879PS',
'HOVA-3000S',
'HOSA-00001',
'HOSA-00002',
'FISA-00008',
'PT52107-08',
'NIBB-00006',
'NIBB-00007',
'NIBD-00006',
'NIBB-00005',
'NIBC-00010',
'NIBC-00011',
'NIBC-00012',
'NIBC-00013',
'NIBC-00014',
'NIBD-00004',
'NIBD-00005',
'5500157L',
'5200104L',
'PALA-00011',
'MESA-00005',
'PALA-00016',
'MESA-00003',
'BMSA-00001',
'LT12021SSA',
'PALA-00002',
'PALA-00003',
'PALA-00004',
'PALA-00005',
'PALA-00007',
'PALA-00008',
'PALA-00012',
'PALA-00014',
'PALA-00015',
'ZBCTRL4',
'ZBR2',
'FIHC-00009',
'5200158L',
'TOSA-00055',
'PCF7K-7018',
'LT5731SDD',
'LT12020SSA',
'LT12200SSA',
'BP-10',
'FBR702',
'FBR703',
'FBR704',
'TOHA-1K1WK',
'TOHA-1G2WK',
'LG9916SSO',
'FBR901',
'FBR902',
'FBR903',
'FBR904',
'E6444',
'LT13007SSA',
'PALA-00028',
'PALA-00026',
'PCF7G-4535',
'26800002L',
'LT6006SSA-B',
'LT6007SSA-B',
'PCF7G-0149',
'FBR512',
'FBR910',
'FBR911',
'FBR912',
'LT16200SSA',
'LT5730SDD',
'605110.00',
'PCT1G-0123',
'PCS1N-6043',
'5200018L',
'E-0012',
'CPP-705',
'2780004L',
'RU120.INT',
'LT12202SSA',
'LT13106SSA',
'IVTD-00068',
'IVTB-00065',
'NIHA-00004',
'NIHB-00007',
'PALA-00059',
'NIBC-00015',
'NIBB-00008',
'LT0405SSA',
'LT0400SSA',
'LT0401SSA',
'LT0402SSA',
'276713.00',
'MESA-00004',
'PALA-00053',
'PALA-00054',
'PALA-00055',
'PALA-00056',
'XX59136-5J8BR',
'PALA-00029',
'PALA-00031',
'PCT9G-9502A',
'PCT9G-9502',
'PALA-00060',
'PALA-00062',
'PALA-00032',
'PALA-00045',
'PALA-00052',
'PT36214-05',
'NISA-00013',
'PCF7N-8051',
'8800040L',
'ZB4200DR',
'LT0409SSA',
'E-0013',
'E-0014',
'E-0015',
'SO-383',
'MESA-00001',
'MESA-00002',
'LT0404SSA',
'APBB-00014',
'UT29HS',
'CP583D',
'LT5723SDD',
'LT0408SSA',
'APBD-00011',
'TF1104',
'AT45H-BL',
'PCT1G-0124',
'PCT1G-0125',
'PCF7N-8052',
'PCF7G-8053',
'LT0406SSA',
'LT0407SSA',
'LT0410SSA',
'PCF7G-0128',
'PCF7G-0129',
'TOBC-4W9MI',
'TOBC-4W9SI',
'TOPD-8007S5',
'PCF7P-1160',
'PCF7P-1161',
'PCF7G-0126',
'PCT1G-0127',
'TOHC-040WS3',
'RCSA-00005',
'RCSA-00006',
'AUSB-00001',
'VWHB-00009',
'AUSA-00002',
'AT285-0047L',
'PPG3805-811A',
'PPG3805-802A',
'PPG3805-802B',
'PCT1G-0131',
'PCT1G-0132',
'PCT1P-1162',
'INTLX-400',
'PPG2004-339A',
'PPG3852-802',
'FBR505',
'FBR905',
'FBR906',
'PCT1N-8054',
'PCT1N-8055',
'PCT1N-8056',
'C190-1051',
'PCF9G-5051',
'PCT1G-0134',
'PCT1G-0135',
'PCT1G-0136',
'TF330',
'PCT1N-8024B',
'PCF9G-4536',
'LT16455SSA',
'LT16078SSA',
'LT16079SSA',
'AM-0004L',
'LT0411SSA',
'PCT1G-0130',
'E6443',
'R74717162',
'PAHE',
'LT0412SSA',
'VWHB-00007',
'PCF9G-6044',
'PCF9G-6045',
'PCT1G-8057',
'PCT1G-8058',
'PCF7G-0133',
'PS6100HE',
'IVTB-00055',
'PCT1G-1134',
'PCT1G-0139',
'WEP94005',
'PCT1T-0140',
'PCT1N-8061',
'PCT1K-0141',
'PCT1N-8059',
'PCT1N-8060',
'PCF7K-8062',
'FBR710',
'FBR711',
'PCT1G-3036',
'IN512.INT',
'VWHB-00008',
'PCT1N-0144',
'LT16080SSA',
'5200042L',
'PCT1G-0137',
'LT0416SSA',
'PCF9G-5504',
'PCF9G-3040',
'PCT1G-0138',
'TF721',
'LT0413SSA',
'LT0414SSA',
'LT0415SSA',
'TOHC-040WK3',
'5500020L',
'AT450-0004L',
'MEVC-00001',
'LT16075SSA',
'CM-118',
'VWPE-00001',
'MEHC-00003',
'MEHA-00004',
'MEHA-00005',
'MEPE-00004',
'AG-0001BR',
'5030004L',
'MJ7050.00',
'PCT1G-0142',
'PCT1G-0143',
'PCS1K-1159',
'MESB-00001',
'1412203.00',
'PCF7G-0145',
'PCT1N-8063',
'PCT1G-2052',
'MEHB-00001',
'MEHB-00002',
'MEHB-00003',
'PALA-00020',
'26800035L',
'5200038L',
'FBR705',
'PCT1G-4024',
'5200047L',
'D812',
'320758L',
'DCH3095',
'MEHA-00006',
'LT15103SSA',
'LT15106SSA',
'LT15016SSO',
'LT15116SSO',
'LT15015SSO',
'RNTD-00002',
'LT15114SSO',
'TOZA-4W9BP',
'PPG2858-019A',
'XB16018B',
'LT0417SSA',
'LT15117SSO',
'LT15107SSA',
'LT16077SSA',
'LT15190SSA',
'PPG2953-602B',
'MEHA-00007',
'MEHC-00002',
'MBVA-00001',
'TOSA-00038',
'AT138BR-0008L',
'PCT1G-0147',
'GXM58021',
'LT1000SSA',
'LT1001SSA',
'LT1002SSA',
'LT1003SSA',
'BMHB-00002',
'250794L',
'FBR0900',
'LT14170SSA',
'LT14177SSA',
'APBB-00015',
'PCT1G-0146',
'OM470',
'CHPI-2000MT',
'APBB-00016',
'APBD-00012',
'FBR032',
'MNPB-00001',
'MNTB-00001',
'MNTD-00001',
'LT20600SSA',
'LT0096SSA',
'LT20010SSA',
'PCT1G-5052',
'PCT1N-1165',
'PCT1N-1166',
'PCT1P-1167',
'250774L',
'5200032L',
'RCHC-00005',
'APBC-00013',
'AT138BR-75L',
'LT0098SSA',
'LT5751SDD',
'XB13034',
'XB13036',
'PCT1K-1163',
'PCT1K-1164',
'PCT1T-8064',
'PCF7G-1109',
'CT4501BR',
'PPG2004-879A',
'LT16076SSA',
'LT16074SSA',
'FBR515',
'NITD-00001',
'NISB-00003',
'CR830',
'CP817',
'LAC-5090FM',
'TG-1465S',
'D764',
'F421',
'FBR031',
'FBR197',
'ZB4200DM',
'LT0418SSA',
'UT65',
'UTLTC20',
'GL0690',
'CK655',
'SR44I',
'LT16071SSA-B',
'CHPI-0051WH',
'TOPD-8106S5',
'TOHC-3P0WS7',
'NIVA-00006',
'PPG4695-810A',
'XB13035',
'OM401',
'VWBC-00006',
'LT16073SSA-B',
'TOHB-8V5WS3',
'LT1367SDD',
'TF726',
'FBR0901',
'PCT1N-1169',
'AUSA-00001',
'LT15034SSA',
'LT15803SSA',
'PCF7P-1161S',
'PCT1K-1168',
'PCT1K-8068',
'PCT1K-8069',
'LT0303SSA',
'LT0302SSA',
'TOHB-070WK3',
'TOHC-070WK4',
'TOHC-AK0WK4',
'TOPC-AK3WK8',
'PALA-00121',
'UTLTC10',
'REBC-00002',
'REBB-00001',
'REBC-00003',
'REBD-00002',
'TF822',
'PCT1G-0148',
'LT0306SSA',
'REBD-00003',
'REBC-00004',
'RCSA-00008',
'VEIC-7276',
'NISA-00005',
'APBD-00013',
'BMPE-00003',
'IVBB-00015',
'PPG5156-805',
'PPG9600-801A',
'LT13015SSA',
'LT16456SSA',
'NIVA-00005',
'F420',
'BU-04',
'FBR029',
'FBR030',
'NISB-00004',
'PT62356-20',
'5322.00',
'8800021L',
'8800022L',
'8800023L',
'NIPC-00001',
'PPG2463-805A',
'GMBC-00035',
'SOLR-7173',
'CR693',
'CP471A',
'CP458A',
'FBR033',
'FBR033.INT',
'LT5730SDD-A',
'MBTB-00013',
'VWHB-00012',
'VWHB-00014',
'VWHB-00013',
'GMBB-00050',
'GMBD-00036',
'GMBD-00038',
'GMPA-00010',
'GMPA-00012',
'GMVA-00010',
'MBTD-00013',
'MBTB-00014',
'MBTD-00014',
'MBTB-00017',
'MBTD-00017',
'GMVB-00006',
'PCF7P-1170',
'8800020L',
'8800024L',
'LT0314SSA',
'LT0310SSA',
'376005L',
'5500065L',
'LT0312SSA',
'LT0322SSA',
'LT0323SSA',
'WX900-2004BR',
'MNTD-00004',
'MNTD-00005',
'MNTD-00008',
'MNTD-00016',
'600-2024BR',
'C565-1051',
'PPG4670-012A',
'A-B620160-FK',
'RESB-00001',
'RABD-00002',
'RABC-00002',
'CP611',
'FBR712',
'FBR713',
'PALA-00123',
'SDES-9000',
'FISB-00002',
'GEL-8130',
'GEL-8138',
'CM-100',
'CM-102',
'CM-103',
'CM-105',
'CM-106',
'CM-107',
'CM-108',
'CM-110',
'D752',
'D753',
'D754',
'D756',
'D759',
'D761',
'D762',
'D763',
'D768',
'D769',
'D770',
'D771',
'D772',
'D776',
'D777',
'D778',
'CM-112',
'CM-116',
'CM-117',
'CM-200',
'CM-201',
'CM-202',
'CM-203',
'CM-204',
'CM-205',
'CM-206',
'CM-207',
'CM-209',
'CM-212',
'CM-213',
'CM-214',
'COR851M',
'CP524',
'CP524DG',
'CP524S',
'CPN-101',
'CPN-203',
'CPN-204',
'CPN-302',
'CPP-101',
'CPP-102',
'CPP-103',
'CPP-104',
'CPP-106',
'CPP-202',
'CPP-203',
'CPP-204',
'CPP-206',
'CPP-302',
'CPP-303',
'CPP-305',
'CPP-308',
'CPP-309',
'CPP-311',
'CPP-314',
'CPP-315',
'CPP-316',
'CPP-317',
'CPP-318',
'CPP-319',
'CPP-320',
'CPP-321',
'CPP-323',
'CPP-324',
'CPP-326',
'CPP-327',
'CPP-328',
'CPP-330',
'CPP-332',
'CPP-501',
'CPP-602',
'CPP-604',
'CPP-701',
'CPP-703',
'CPP-704',
'CPP-707',
'CPP-708',
'CPS-101',
'CPS-102',
'CPS-204',
'CPS-205',
'CPS-303',
'CPU-101',
'CPU-102',
'CPU-103',
'CPU-104',
'CPU-105',
'CPU-201',
'CR-309',
'CR-311',
'CR-315',
'CR-332',
'CR-338',
'CR-377',
'CR-600',
'CR-603',
'CR-604',
'CR659BL',
'CR681',
'CR691B',
'CS59',
'CS59S-IT',
'CS6-IT',
'D700',
'D717',
'D721',
'D740',
'D741',
'D746',
'D748',
'D750',
'D751',
'CM-069',
'CM-070',
'CM-071',
'CM-074',
'CM-075',
'CM-076',
'CM-077',
'CM-078',
'NPH1QAK',
'NPX5095',
'NU126-0004L',
'NU126-026L',
'NU126-113L',
'NU126-BL',
'P190-376',
'P190-625',
'PCF6G.0043DB',
'PCF6G.1040',
'PCF6G.1454',
'PCF6G.1491',
'PCF6G.1991',
'PCF6G.90173',
'PCF6G.90188',
'PCF6G.90190',
'PCF6N.8003',
'PCF6N.8005',
'PCF7G-0087M',
'P192-475',
'P192-528',
'P192-5600',
'P210-6270',
'P210-6285',
'P210-842',
'P210-922',
'P210-925',
'P425-900',
'P425-948',
'P425-950',
'P425-984',
'P425-985',
'P425-988',
'P425-992',
'P426-HE01',
'P565-5301',
'P565-5305',
'P565-5307',
'P565-888',
'P850-1393',
'P850-1401',
'P850-1492',
'P9758',
'P9758B',
'P976',
'P9762',
'P980-5000',
'PALA-00001',
'PALA-00006',
'PALA-00009',
'PALA-00010',
'PALA-000118',
'PALA-00013',
'PALA-00018',
'PALA-00034',
'PALA-00100',
'PALA-00101',
'PALA-00102',
'PALA-00103',
'PALA-00104',
'PALA-00105',
'PALA-00106',
'PALA-00107',
'PALA-00111',
'PALA-00113',
'PALA-00114',
'PALA-00118',
'PALA-00119',
'PALA-00122',
'PALA-00124',
'PALA-00125',
'PALA-00126',
'PALA-00127',
'PALA-00128',
'PALA-00129',
'PALA-00130',
'PALA-00131',
'PALA-00132',
'PALA-00133',
'PALA-00134',
'PALA-00135',
'PALA-00136',
'PALA-00137',
'PALA-00138',
'PALA-00139',
'PALA-00140',
'PALA-00142',
'PALA-00143',
'PALA-00144',
'PALA-00145',
'PALA-00146',
'PALA-00147',
'PALA-00148',
'PALA-00149',
'PALA-00150',
'PALA-00151',
'PALA-00152',
'PALA-00153',
'PALA-00154',
'PALA-00155',
'PALA-00156',
'PALA-00157',
'PALA-00158',
'PCF0G.1022',
'PCF0N-1135',
'PCF0N.2015',
'PCF4N.9998',
'PCF5N.1627',
'PCF5N.1691',
'PCF6G-1491B',
'NLBC-K23P',
'NLBC-K36P',
'NLBC-KH3P',
'NLBC-QACBP',
'NLBC-QACPP',
'NLBC-QM1P',
'NLBC-RBKP',
'NLSA-00001',
'TOVA-00008',
'TOVA-00010',
'TOVA-00016',
'TOVA-00017',
'TOVA-713BC',
'TOVA-7172S',
'TOZA-00014',
'TOZA-00070',
'ZM430',
'ZM434',
'ZM438',
'ZM440',
'ZM450',
'ZM451',
'ZM462',
'ZM463',
'ZM464',
'ZM465',
'ZM466',
'ZM469',
'ZM477',
'TOZA-00071',
'TOZA-00072',
'TOZA-00074',
'TOZA-058BS',
'TOZA-070BP',
'TOZA-070MC',
'TOZA-070RP',
'TOZA-070RS',
'TOZA-1H6RS',
'TOZA-1J3RS',
'TOZA-215RS',
'TOZA-3R3BP',
'TOZA-5A3RS',
'TOZA-785RS',
'UDM95566B',
'UGA',
'UGSWHDE',
'UT92D',
'UT95WP',
'UTEC892D',
'VEIC-7272',
'VWHA-00005',
'VWHA-00008',
'VWHA-00010',
'VWHA-00011',
'VWHA-00012',
'VWHB-00004',
'VWHB-00005',
'VWHB-00006',
'VWHC-00002',
'VWHC-00003',
'VWHC-00005',
'VWHC-00006',
'VWSA-00004',
'VWSB-00001',
'VWTB-00009',
'VWTD-00001',
'VWVB-00004',
'W49180C',
'W7122',
'W7815',
'W7821',
'W7826',
'W7910',
'WE-22-1101-BR',
'WE-33-7744-BR',
'WE-38-3550-BR',
'WE-39-8534-BR',
'WE-48-3739-BR',
'WE-55-6547-BR',
'WE-58-2954-BR',
'WE-66-7667-BR',
'WE-67-9751-BR',
'WE-74-5044-BR',
'WE-75-1561-BR',
'WE-79-5458-BR',
'WE-84-5115-BR',
'WE-89-1162-BR',
'WE-93-7263-BR',
'WE2740-BR',
'WEG-3336-BR',
'WF1520SDD',
'XB02029M',
'XB99010',
'XB99011',
'XB99047',
'ZB4200SM',
'ZB4200SR',
'ZBADDZR',
'ZM400',
'ZM401',
'ZM402',
'ZM403',
'ZM404',
'ZM405',
'ZM406',
'ZM407',
'ZM408',
'ZM410',
'ZM411',
'ZM412',
'ZM413',
'ZM414',
'ZM415',
'ZM416',
'ZM417',
'ZM419',
'ZM421',
'ZM422',
'ZM423',
'ZM424',
'ZM425',
'ZM426',
'ZM427',
'ZM428',
'TOSA-TSW3S',
'TOSB-00001',
'TOSB-00003',
'TOSB-500TL',
'TOSB-6100K',
'TOTB-00019',
'TOTB-00020',
'TOTB-058MS',
'AT385HS-147L',
'CM-073',
'LT930212SSA',
'FIBC-00014',
'GEL-8134',
'FD',
'PCT1G-0120T',
'IVTB-00027',
'IVTD-00019',
'VWHA-00016',
'CK181ALP.AA',
'CK2010LP.AA',
'CPP-304',
'CPP-306',
'CPP-310',
'CPP-312',
'CPP-313',
'CPP-502',
'PPG2613-202A',
'PPG2658-007A',
'PPG2658-104A',
'PPG2858-017A',
'PPG2858-018A',
'PPG2953-301A',
'PPG2953-305A',
'PPG2953-306A',
'PPG2954-301A',
'PPG3190-313A',
'PPG3805-802',
'PPG3961-303A',
'PPG5032-804A',
'PPG9201-803A',
'RA1025',
'RN4250',
'TG-0965',
'TOPC-00007',
'TOSA-00036',
'TOZA-3S1RS',
'DUL631',
'DUL697',
'DUL700',
'L1288',
'L1358',
'PPG2238-303A',
'PPG2463-305A',
'PPG2463-807A',
'PPG2541-304A',
'AK2-23L.00',
'AK400-BL',
'AT101L',
'AT138BR-74L',
'AT138BR-74L.00',
'AT138BR-BL.00',
'AT385-3L',
'CDX400RP',
'CF700A-M.AA',
'CF700B-M.AA',
'CF700R-M.AA',
'APBC-00006',
'APBC-00007',
'APBC-00008',
'26800063L',
'26800064L',
'TOSA-TSS3IN',
'LT1927SDD',
'TOSA-NK53SC',
'LT13230SSA',
'RABC-00001',
'RABB-00001',
'RABB-00002',
'RCPB-00007',
'MNBB-00001',
'MNTB-00004',
'MNTB-00005',
'MNTB-00008',
'MNVA-00001',
'284505BR',
'APBE-00001',
'BMSB-00001',
'CM-017',
'CM-019',
'CM-031',
'CM-033',
'CM-035',
'CM-038',
'CM-040',
'CM-042',
'CM-043',
'CM-050',
'CM-060',
'CM-062',
'CM-063',
'CM-064',
'CM-065',
'CM-068',
'C551-9446',
'C551-9500',
'C551-9800',
'C562-1141',
'C562-1142',
'C562-1143',
'C565-6121',
'C565-6122',
'C565-6300',
'C565-6408',
'C565-6504',
'C565-7000',
'C565-7007',
'C565-7041',
'C572-6402',
'C580-9415',
'C850-0600',
'C850-0900',
'C850-1100',
'C850-3800',
'C950-9441',
'CA636',
'CA708B',
'CAUST',
'CC3625XLV',
'CF-N',
'CF51HD',
'CF700A',
'CF700A-IT',
'CF700B',
'CF700B-IT',
'CF700F-IT',
'CF700FF-IT',
'CF700R',
'CF700RSH-IT',
'CFFSA',
'CFLADD',
'CFLADD-M',
'CFZN',
'CHPI-0010BL',
'CHPI-0020YL',
'CHPI-0021YL',
'CHPI-0030RD',
'CHPI-0040GR',
'CHPI-0041GR',
'CHPI-0050WH',
'CHPI-0060VI',
'CHPI-0061VI',
'CHPI-0070RX',
'CHPI-0080YX',
'CHPI-0090LA',
'CHPI-0090OR',
'CHPI-0100AL',
'CHPI-0101AL',
'CHPI-9000CL',
'CHPI-9010CL',
'CK1100',
'CK163',
'CK166M',
'CK166MS-IT',
'CK171',
'CK171-11-IT',
'CK392C',
'CK39F',
'CK611L',
'CK611LS',
'CL-500',
'CL-502',
'CL-510',
'CL-512',
'CL-513',
'CL-517',
'CL-530',
'CL-531',
'CL-533',
'CL-535',
'CL-537',
'CL-539',
'CL-542',
'CL-544')
or msi.segment1 in (
'CL-546',
'CL-548',
'CL-549',
'CL-550',
'CL-551',
'CL-553',
'CL-554',
'CL-555',
'CL-556',
'CL-560',
'CLBB-00001',
'CLSA-00001',
'CLTD-00001',
'CM-001',
'CM-002',
'CM-003',
'CM-007',
'CM-010',
'CM-011',
'CM-015',
'CM-016',
'LT5381WSA',
'LT5711SDD',
'LT5715SDD',
'LT5718SDD',
'LT5728SDD',
'LT5845SSO',
'NIHP-QAKPB',
'NISA-00001',
'NISA-00002',
'NISA-00004',
'NISA-00009',
'NISA-00010',
'NISA-00011',
'NISA-00012',
'NISA-T6000',
'NISB-00001',
'NISB-00002',
'NIVA-00001',
'NIVA-00002',
'NIVA-00003',
'NIVA-T6000',
'NLBC-A20P',
'LT6006SSA-A',
'LT6007SSA-A',
'LT6500SSA',
'LT6528SSO',
'LT65422BRSSA',
'LT6906SSA',
'LT6913SSA',
'LT6914SSA',
'LT6916SSA',
'LT6917SSA',
'LT6918SSA',
'LT6919SSA',
'LT6939SSA',
'LT7095SIA',
'LT7098SSA',
'LT7099SSA',
'LT71294BRSSA',
'LT7236JBRSSA',
'LT7274BRSSA',
'LT8840SSA',
'LT8841SSA',
'LT8853SSA',
'LT8858SSA',
'LT8859SSA',
'LT8860SSA',
'LT8867SSA',
'LT8879SSA',
'LT8886SSA',
'LT8909SSA',
'LT917954BRSSA',
'LT932767BRSSA',
'LT933851BRSSA',
'MBPB-00001',
'MBSB-00001',
'MBSB-00002',
'MBTB-00012',
'MBTB-00018',
'MBTB-00019',
'MBTB-00020',
'MBTD-00012',
'MBTD-00018',
'MBTD-00019',
'MBTD-00020',
'MJ6955',
'MZD40940',
'MZD40941',
'MZD7330',
'NB2QAC',
'NB2QM1',
'NIAP-00001',
'NIAP-B10PT',
'NIBB-00001',
'NIBB-00002',
'NIBB-00003',
'NIBC-00001',
'NIBC-00002',
'NIBC-00003',
'NIBC-00004',
'NIBC-00005',
'NIBC-00006',
'NIBC-00007',
'NIBC-00008',
'NIBC-00009',
'NIBD-00001',
'NIBD-00002',
'NIBD-00003',
'NIHA-00001',
'NIHA-00002',
'NIHA-K23CB',
'NIHA-K36CB',
'NIHB-00001',
'NIHB-00002',
'NIHB-00003',
'NIHB-00004',
'NIHB-00005',
'NIHB-00006',
'NIHB-QACCB',
'NIHB-RBKCB',
'NIHC-00001',
'NIHC-00002',
'NIHC-00003',
'NIHC-00004',
'NIHC-00005',
'NIHC-A20CB',
'NIHC-KH3CB',
'NIHC-QM1CB',
'NIHP-00001',
'NIHP-00002',
'NIHP-00003',
'NIHP-K23PB',
'NIHP-KH3PB',
'LT1462SDD',
'LT1465SDD',
'LT1490SDD',
'LT1669SDD',
'LT1680SDD',
'LT1965SDD',
'LT3007BRSSA',
'RR73B',
'RS902',
'RS904',
'RS912',
'RS913',
'RU120',
'SO-228',
'SOLR-7114',
'TOSA-00037',
'TOSA-00039',
'TOSA-00044',
'TOSA-00045',
'TOSA-00046',
'TOSA-00052',
'TOSA-00053',
'TOSA-00054',
'TOSA-13RCS',
'TOSA-3331K',
'TOSA-5A3MS',
'TOSA-7172S',
'TOSA-NK53S',
'TOSA-NK5A3S',
'TOSA-SD60S',
'TOSA-TSS3K',
'SPEG-153',
'SR22',
'STCL247',
'SU44090',
'TF-2016BR',
'TF1200',
'TF1201',
'TF1203',
'TF901',
'TF913',
'TG-0948',
'TG-0962',
'TKU2000CP',
'TKU2000CS',
'TOBB-00008',
'TOBB-00010',
'TOBB-00011',
'TOBB-00014',
'TOBB-00016',
'TOBB-00018',
'TOBB-1D6MZ',
'TOBB-1D6SZ',
'TOBB-1G3MZ',
'TOBB-1G3SZ',
'TOBC-00001',
'TOBC-00004',
'TOBC-070MI',
'TOBC-070MZ',
'TOBC-070SI',
'TOBC-070SZ',
'TOBC-1H2MZ',
'TOBC-1H2SZ',
'TOBC-218MZ',
'TOBC-218SZ',
'TOBC-3R3MI',
'TOBC-3R3SI',
'TOBC-3T6MZ',
'TOBC-3T6SZ',
'TOBC-4W9MZ',
'TOBC-4W9SZ',
'TOBC-5A7MZ',
'TOBC-5A7SZ',
'TOBC-6T8MI',
'TOBC-6T8SI',
'TOBD-00003',
'TOBD-00004',
'TOBD-070MI',
'TOBD-070MZ',
'TOBD-5A3MS',
'TOHA-1F2WK',
'TOHA-1H6WS',
'TOHA-1J3WK',
'TOHA-1J3WS',
'TOHA-8W4WS',
'TOHB-070WS',
'TOHB-215WS',
'TOHB-3S1WK',
'TOHB-3S1WS',
'TOHB-785WK',
'TOHB-785WS',
'TOHC-058WK',
'TOHC-070WS',
'TOHC-5A3WK',
'TOHC-5A3WS',
'TOPB-00013',
'TOPB-00015',
'TOPB-00016',
'TOPB-00017',
'TOPB-00019',
'TOPB-00026',
'TOPB-070BI',
'TOPB-070PZ',
'TOPC-00001',
'TOPC-00008',
'TOPC-00009',
'TOPC-070SI',
'TOPC-070SZ',
'TOPC-3300C',
'TOPC-3300N',
'TOPC-7018K',
'TOPC-AJ3WK',
'TOPC-AK0WK',
'TOPD-503WS',
'TOPD-7018S',
'TOPD-8007S',
'TOSA-00017',
'TOSA-00019',
'TOSA-00021',
'TOSA-00023',
'TOSA-00025',
'TOSA-00027',
'TOSA-00029',
'TOSA-00031',
'TOSA-00033',
'TOSA-00034',
'TOSA-00035',
'RF197',
'RN1508',
'RNHA-00002',
'RNHA-00004',
'RNHB-00001',
'RNSB-00002',
'RNTD-00001',
'RP133',
'UT32',
'C210-0020',
'PCF7G.1070',
'141343L',
'153870L',
'155051L',
'155822L.00',
'157367L.00',
'157369L',
'185280L',
'191021L',
'202663L',
'215871L',
'224100L',
'231785L',
'231786L',
'239981L',
'250773L',
'250779L',
'254146L',
'254175L.00',
'26800007L',
'26800082L',
'26800100L',
'26800101L',
'2690004L',
'269558L',
'271206L',
'280669L',
'311992L',
'3290038L',
'4100075L',
'4100082L',
'5500004L',
'5500040L',
'5500085L',
'5500103L',
'5660034L',
'5900011L',
'5900016L',
'5900084L',
'6030004L',
'6300003L',
'AK2-0004L',
'0480077L',
'0480086L',
'105640L',
'136776L',
'TF734',
'TF401',
'APBB-00008',
'TF720',
'MNTB-00016',
'RABD-00001',
'MNBB-00005',
'LT0316SSA',
'LT0319SSA',
'LT0320SSA',
'PPG3825-803A',
'CA285',
'LT1938SDD',
'PCF7N-2053',
'CPP-353',
'CPP-352',
'CPP-351',
'CPP-109',
'CPP-108',
'CPP-350',
'FIHB-00006',
'FIHB-00007',
'FIHA-00005',
'CR691A',
'NIBB-00009',
'PCT1G-1153',
'PCT1N-8050',
'PCT1G-7016',
'LT0315SSA',
'LT0317SSA',
'LT0318SSA',
'LT0321SSA',
'8800013L',
'8800081L',
'8800089L',
'8800113L',
'8800118L',
'8800119L',
'A-I101575',
'A400',
'C086-6405',
'C100-3402',
'C100-9305',
'C190-0640',
'C190-0900',
'C190-0950',
'C190-0970',
'C190-0998',
'C190-1021',
'C190-3068',
'C210-0999',
'C210-3504',
'C210-9602',
'C271-0100',
'C275-3123',
'C275-312X',
'A4000I39',
'ADJ-002',
'AK-0AL',
'AK-0BL',
'AK2-0005L',
'AK2-0055L',
'AK2-0082L',
'AK2-0111L',
'AK2-141L',
'AK2-23L',
'AK2-BL',
'AK2-T1L',
'AK2-T2L',
'AK2-T3L',
'ALF100RTU',
'ALF200RTU',
'AM-0026L',
'AM-0102L',
'AM-0142L',
'AM-BL',
'AMC232',
'AP3306C',
'APBD-00002',
'APPD-00001',
'APPD-00002',
'APVC-00001',
'AT138BR-026L',
'AT138BR-121L',
'AT138BR-144L',
'AT138BR-83L',
'AT138BR-96L',
'AT138BR-BL',
'AT240-20L',
'AT240-35L',
'AT240-72L',
'AT240-BL',
'AT385-0004L',
'AT385-032L',
'AT385-BL',
'AT385HS-0004L',
'AT385HS-004L',
'AT385HS-008L',
'AT385HS-032L',
'AT385HS-063L',
'AT385HS-064L',
'AT385HS-111L',
'AT385HS-112L',
'AT385HS-130L',
'AT385HS-81L',
'AT385HS-BL',
'AT450-026L',
'AT450-BL',
'AT880L',
'AT90-0003L',
'AT90-0004L',
'AT90-BL',
'ATP50R',
'AUHB-00001',
'AUHC-00001',
'B4P4023',
'B609',
'BMHA-00001',
'BMHA-00002',
'BMHA-00003',
'BMHB-00001',
'BMHC-00001',
'BMHC-00002',
'BMPE-00001',
'BMPE-00002',
'BMVC-00001',
'BN-01',
'BP-01',
'BP-04',
'BP-05',
'BP-06',
'BP-08',
'BP-09',
'BS-01',
'BS-02',
'BS-04',
'BTB-DYE',
'BTCL8009',
'BU-01',
'BU-02',
'BU-03',
'BUF',
'BUFM-IT',
'C083-4090',
'C084-6419',
'C086-6210',
'C086-6217',
'65100516',
'7900',
'7947',
'7949',
'7957',
'861-06L',
'8800003L',
'8800011L',
'LT13006SSA-A',
'LT13013SSA',
'LT13504SSA',
'LT13513SSA',
'LT1366SDD',
'LT14002SSA',
'LT14006SSA',
'LT14007SSA',
'LT14008SSA',
'LT14010SSA',
'LT14011SSA',
'LT14045SSA',
'LT1453SDD',
'INTPMC-8047',
'INTPMC-809',
'INTPMC-8847',
'INTPO-2449',
'INTPO-2450',
'IP2092-7303I',
'IVBB-00008',
'IVBB-00009',
'IVBB-00011',
'IVBB-00013',
'IVBB-00014',
'IVBC-00002',
'IVPA-00001',
'IVPA-00003',
'IVSA-00002',
'IVSA-00003',
'IVSA-00004',
'IVSB-00001',
'IVTB-00005',
'IVTB-00008',
'IVTB-00010',
'IVTB-00015',
'IVTB-00017',
'IVTB-00019',
'IVTB-00021',
'IVTB-00024',
'IVTB-00025',
'IVTB-00038',
'IVTB-00047',
'IVTB-00050',
'IVTB-00051',
'IVTB-00052',
'IVTB-00061',
'IVTB-00062',
'IVTB-00063',
'IVTD-00003',
'IVTD-00005',
'IVTD-00010',
'IVTD-00011',
'IVTD-00012',
'IVTD-00014',
'IVTD-00015',
'IVTD-00018',
'IVTD-00021',
'IVTD-00022',
'IVTD-00032',
'IVTD-00035',
'IVTD-00038',
'IVTD-00042',
'IVTD-00045',
'IVTD-00046',
'IVTD-00048',
'IVTD-00049',
'IVTD-00050',
'IVTD-00060',
'IVTD-00061',
'IVTD-00062',
'IVTD-00063',
'IVVB-00002',
'KW1238',
'LG5571SSO',
'LG6137SIO',
'LT0001SDD',
'LT0002SSA',
'LT0003SSA',
'LT0007SSA',
'LT0014SSO',
'LT0015SSO',
'LT0016SSO',
'LT0017SSO',
'LT0019SSA',
'LT0020SSA',
'LT0023SDD',
'LT0032SSA',
'LT0033SSA',
'LT0034SSA',
'LT0039SDD',
'LT0044SSO',
'LT0045SSA',
'LT0048SSA',
'LT0052SSO',
'LT0065SSA',
'LT0069SSA',
'LT0071SSA',
'LT0078SSA',
'LT0079SSA',
'LT0081SSO',
'LT0090SSA',
'LT0091SSO',
'LT0095SSA',
'LT0807SDD',
'LT0841SDD',
'LT11002SDD',
'LT1127SDD',
'LT13001SSA-D',
'LT13002SSA-A',
'LT13003SSA-A',
'LT13004SSA-A',
'LT13005SSA-A',
'PPG2953-605A',
'PPG2954-601A',
'PPG2954-803A',
'PPG2954-805A',
'PPG2954-806A',
'PPG2954-807A',
'PPG2955-002A',
'PPG2970-808A',
'RD533',
'RD534',
'REHA-00008',
'REHA-00011',
'REHA-00012',
'REHA-00013',
'REHB-00002',
'REHB-00004',
'REHB-00015',
'REHB-00017',
'REHB-00020',
'REHB-00022',
'REHB-00023',
'REHB-00024',
'RETE-00001',
'REVA-00002',
'PPG2987-804B',
'PPG2987-805B',
'PPG3109-801A',
'PPG3190-810A',
'PPG3803-830A',
'PPG3805-803',
'PPG3825-803',
'PPG3825-804A',
'PPG3825-823A',
'PPG3864-802',
'PPG4014-601A',
'PPG4670-003P',
'PPG4670-008A',
'PPG4670-009A',
'PPG4681-801',
'PPG4695-802A',
'PPG4695-805A',
'PPG4695-806A',
'PPG4699-803',
'PPG4699-803P',
'PPG5032-301A',
'PPG5032-301B',
'PPG5032-801A',
'PPG5078-801A',
'PPG5078-804A',
'PPG5079-001A',
'PPG5079-004A',
'PPG7940-303B',
'PPG7940-309A',
'PPG9201-809A',
'PPG9201-810A',
'PPG9203-802',
'PPG9203-803A',
'PRLX2',
'PRLX3',
'PRLX4',
'PRLX6',
'PS4060',
'PSL97',
'PSL97ADD',
'PT20851-03',
'PT43696-51',
'PT50041-13',
'PT59000-51',
'PT72868-20',
'R00269196',
'R01740097',
'R02620302',
'R02817397',
'R03820302',
'R04215397',
'R05140086',
'R05520302',
'R09035233',
'R22640086',
'R41020097',
'R41120097',
'R41220097',
'R41420097',
'R44110287',
'R56512162',
'R58562585',
'R58640085',
'R59712232',
'R71035333',
'R80020302',
'R85740087',
'R86419162',
'R87240086',
'R89712162',
'R92861196',
'RB186',
'RC186',
'RC191',
'RC197',
'RC897',
'RCHC-00001',
'RCHC-00002',
'RCPB-00006',
'RCPC-00005',
'RCSA-00004',
'RCSA-00015',
'RCSA-00043',
'RCVA-00001',
'RCVA-00002',
'RD500',
'RD502',
'RD504',
'RD507',
'RD508',
'RD509',
'RD511',
'RD517',
'RD520',
'RD530',
'PPG2952-805A',
'PPG2953-302A',
'PPG2953-303A',
'PPG2953-304A',
'PPG2953-601A',
'PPG2953-602A',
'PPG2953-603A',
'PPG2953-604A',
'AT138BR-80L',
'TOTB-00020.INT',
'APTD-00002',
'APBD-00008',
'APBB-00010',
'APBC-00009',
'APBB-00005',
'APBB-00011',
'APBC-00003',
'APBD-00003',
'AT138BR-032L',
'8800150L',
'8800153L',
'TF121',
'TF325',
'TF517',
'LT6003SSA-B',
'PPG2004-845A',
'R22640086.INT',
'E6279',
'AT450-113L',
'HSL926188BR',
'PCT1G-3028',
'PCT1G-3039B',
'PCT1G-1154B',
'PCT1G-4534B',
'TOPC-LPP1SO',
'APBB-00017',
'TOSA-LPP1SO',
'PPG103',
'900-1542BR',
'PCS1G-1174')
--
    UNION ALL
--    
    -- Parte RECURSIVA
--
--
    SELECT c.segment1,
           fmdi.inventory_item_id,
--    
           case 
              when fmdi.scale_type = 0 then
                 ((fmdi.qty / fmi.qty) / vri.std_qty) * c.qty
              when fmdi.scale_type = 1 then
                 (fmdi.qty / fmi.qty) * c.qty
              else
                 (fmdi.qty / fmi.qty) * c.qty
           end qty ,
           fmdi.formula_id,
           gri.recipe_id,
           fmdi.organization_id,      
           c.nivel + 1
--           
      FROM apps.fm_form_mst_b fmsi
      join apps.fm_matl_dtl   fmi  
        on NVL(fmsi.formula_class,'SM') <> 'TING-PMC' AND
           fmsi.formula_id               = fmi.formula_id
--
      join apps.gmd_recipes_b gri
        on gri.recipe_status        in (700,900)            AND
           gri.recipe_id            = (select max(gr1.recipe_id)
                                         FROM apps.gmd_recipes_b gr1,
                                              apps.gmd_recipe_validity_rules vr1
                                        WHERE vr1.delete_mark                 = 0                   AND
                                              vr1.preference                  = 1                   AND      
                                              vr1.recipe_use                  = 0 /*Custos*/       AND
                                              vr1.validity_rule_status       in (700,900)           AND
                                              vr1.start_date                 <= sysdate             AND
                                              vr1.end_date                   is NULL                AND
                                              vr1.organization_id             = fmi.organization_id AND
                                              vr1.recipe_id                   = gr1.recipe_id       AND
                                              gr1.recipe_status              in (700,900)           AND
                                              gr1.formula_id                  = fmi.formula_id)       
--                   
--
      join apps.gmd_recipe_validity_rules vri
        on /**** performance ****/
           vri.preference                  = 1                   AND      
           vri.delete_mark                 = 0                   AND
           vri.recipe_use                  = 0                   AND --Custos 
           vri.validity_rule_status       in (700,900)           AND 
           vri.start_date                 <= sysdate             AND
           NVL(vri.end_date,(SYSDATE + 1)) > sysdate             AND
           vri.organization_id             = fmi.organization_id AND           
           vri.recipe_id                   = gri.recipe_id
           /**** performance ****/
--           
      join apps.fm_matl_dtl fmdi
        on fmdi.line_type           = -1                    AND
           fmdi.formula_id          = fmi.formula_id        AND
           fmdi.formula_id          = gri.formula_id        AND
           fmdi.organization_id     = fmi.organization_id    
--
--           
      join apps.mtl_system_items_b msii
        on fmi.inventory_item_id   = msii.inventory_item_id AND
           fmi.line_type           = 1                      AND
           msii.inventory_item_id  = fmi.inventory_item_id  AND
           msii.organization_id    = fmi.organization_id 
           --
--           
      join  cteMenuNivel c 
        on msii.inventory_item_id = c.inventory_item_id AND
           fmdi.inventory_item_id <> c.inventory_item_id and
           c.nivel                < 20
)      
--
--cycle inventory_item_id set is_cycle to '1' default '0'
--
SELECT mp.organization_code,
       c.segment1,
       punb.un_number ONU,
       msib.attribute1 "SIRE",
       msib.attribute2 "Desc Legal",
       phc.description "Class Risco",
       msib.attribute3 "Class Embalagem",
       inventario.categoria,
       msib.inventory_item_status_code,
       msi.segment1 Ingrediente,
       TRANSLATE(TRANSLATE(SUBSTR(msi.description,1,80),'ABCDEFGHIJKLMNOPQRSTUWVXYZabcdefghijklmnopqrstuwvxyz01234567890ÑÁÉÍÓÚÀÈÌÒÙÂÊÎÔÛÃÕÄËÏÖÜÇñáéíóúàèìòùâêîôûãõäëïöüçºª²°.-!"''`#$%().:[/]{}¨+???¿;§&´*<>'
                                                       ,'ABCDEFGHIJKLMNOPQRSTUWVXYZabcdefghijklmnopqrstuwvxyz01234567890NAEIOUAEIOUAEIOUAOAEIOUCnaeiouaeiouaeiouaoaeiouc-'),CHR(10),' ') "Descricao",
       pun.un_number "ONU Ingrediente",  
       msi.attribute1 "SIRE",
       msi.attribute2 "Desc Legal",
       msi.attribute3 "Class Embalagem",
--       msi.primary_uom_code,
       msi.item_type,
       --c.formula_id,
       --c.inventory_item_id,
       c.qty,
       --c.Nivel,
--       
--       MSI.GLOBAL_ATTRIBUTE2       "Classe da Cond da Transação",
--       MSI.GLOBAL_ATTRIBUTE3       "Origem do Item",
--       MSI.GLOBAL_ATTRIBUTE4       "Tipo Fiscal do Item",
--       MSI.GLOBAL_ATTRIBUTE6       "Situação Trib Estadual",
--      MSI.GLOBAL_ATTRIBUTE5       "Situação Trib Federal",
--      MSI.GLOBAL_ATTRIBUTE10      "EAN13",
--       MSI.GLOBAL_ATTRIBUTE16      "Importar Conteudo",
--       MSI.GLOBAL_ATTRIBUTE17      "Valor Parcela estrangeira",
--       MSI.GLOBAL_ATTRIBUTE18      "Valor Total Envio Inter",
--       MSI.GLOBAL_ATTRIBUTE19      "Numero FCI",       
       FISCAL_CLASSIFICATION.CATEGORIA "NCM"       
--       
--       
--       
  FROM cteMenuNivel c,
       apps.mtl_system_items_b   msi,
       apps.mtl_system_items_b   msib,
       apps.po_un_numbers        pun,
       apps.po_un_numbers        punb,
       apps.mtl_parameters       mp,
       apps.PO_HAZARD_CLASSES_TL phc,
       (SELECT MIC.INVENTORY_ITEM_ID,
               MIC.ORGANIZATION_ID,
               MIC.CATEGORY_SET_NAME,
               MIC.CATEGORY_CONCAT_SEGS CATEGORIA
          FROM APPS.MTL_ITEM_CATEGORIES_V MIC, APPS.MTL_CATEGORIES_V MC
         WHERE MC.CATEGORY_ID = MIC.CATEGORY_ID
           AND MIC.CATEGORY_SET_NAME IN ('FISCAL_CLASSIFICATION')) FISCAL_CLASSIFICATION,
       (SELECT MIC.INVENTORY_ITEM_ID,
               MIC.ORGANIZATION_ID,
               MIC.CATEGORY_SET_NAME,
               MIC.CATEGORY_CONCAT_SEGS CATEGORIA
          FROM APPS.MTL_ITEM_CATEGORIES_V MIC, APPS.MTL_CATEGORIES_V MC
         WHERE MC.CATEGORY_ID = MIC.CATEGORY_ID
           AND MIC.CATEGORY_SET_NAME IN ('Inventory')) INVENTARIO
--           
 WHERE mp.organization_id         = c.organization_id    AND
       phc.hazard_class_id(+)     = msib.hazard_class_id AND
       phc.language(+)               = 'PTB'                AND
       msib.segment1              = c.segment1           AND
       msib.organization_id       = c.organization_id    AND
       pun.un_number_id(+)        = msi.un_number_id     AND
       punb.un_number_id(+)       = msib.un_number_id    AND
       msi.inventory_item_id      = c.inventory_item_id  AND
       msi.organization_id        = c.organization_id    AND
       msib.ORGANIZATION_ID       = INVENTARIO.ORGANIZATION_ID(+) AND
       msib.INVENTORY_ITEM_ID     = INVENTARIO.INVENTORY_ITEM_ID(+) AND
--       
     --  msi.planning_make_buy_code = 2                   AND
     --  msi.item_type             <> 'INS/EMB'           AND
     --  msi.item_type             <> 'MISC'           AND
       MSI.ORGANIZATION_ID        = FISCAL_CLASSIFICATION.ORGANIZATION_ID(+) AND
       MSI.INVENTORY_ITEM_ID      = FISCAL_CLASSIFICATION.INVENTORY_ITEM_ID(+)
       order by 1,2,4;

select * from apps.mtl_system_items_b where segment1 in ('SRC-75','HE-15-8633');