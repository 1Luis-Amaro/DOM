

--WITH cteMenuNivel(id,Nome,Nivel,NomeCompleto)
--AS
--(
--    -- Ancora
--    SELECT id,Nome,1 AS 'Nivel',CAST(Nome AS VARCHAR(255)) AS 'NomeCompleto' 
--    FROM tbMenu WHERE idPai IS NULL
--    
--    UNION ALL
    
--    -- Parte RECURSIVA
--    SELECT 
--        m.id,m.Nome,c.Nivel + 1 AS 'Nivel',
--        CAST((c.NomeCompleto + '/' + m.Nome) AS VARCHAR(255)) 'NomeCompleto' 
--    FROM tbMenu m INNER JOIN cteMenuNivel c ON m.idPai = c.id
    
--)
--SELECT Nivel,NomeCompleto FROM cteMenuNivel




WITH cteMenuNivel(segment1,inventory_item_id,qty, qty_cst, formula_id, recipe_id, organization_id, Nivel)
AS
(
    -- Ancora
    SELECT msi.segment1,
           fmd.inventory_item_id,
           CASE
              --WHEN msip.planning_make_buy_code  = 1 THEN
              --   1
              WHEN fmd.scale_type = 0 THEN
                 (fmd.qty / fm.qty) / vr.std_qty
              WHEN fmd.scale_type = 1 THEN
                 (fmd.qty / fm.qty)
              ELSE
                 (fmd.qty / fm.qty)
           END qty ,
          CASE
              --WHEN msip.planning_make_buy_code  = 1 THEN
              --   1
              WHEN fmd.scale_type = 0 THEN
                 ((fmd.qty / fm.qty) / vr.std_qty) / (1 - (vr.planned_process_loss / 100))
              WHEN fmd.scale_type = 1 THEN
                 (fmd.qty / fm.qty) / (1 - (NVL(vr.planned_process_loss,0 / 100)))
              ELSE
                 (fmd.qty / fm.qty) / (1 - (NVL(vr.planned_process_loss,0) / 100))
           END qty_cst,   
           fmd.formula_id,
           gr.recipe_id,
           fmd.organization_id,
           0 as Nivel
      FROM apps.fm_form_mst_b fms,
           apps.fm_matl_dtl   fm,
           apps.fm_matl_dtl   fmd,
           apps.gmd_recipes_b gr,
           apps.gmd_recipe_validity_rules vr,
           apps.mtl_system_items_b msi,
           apps.mtl_system_items_b msip,
           (SELECT MIC.INVENTORY_ITEM_ID,
                   MIC.ORGANIZATION_ID,
                   MIC.CATEGORY_SET_NAME,
                   MIC.CATEGORY_CONCAT_SEGS CATEGORIA
              FROM APPS.MTL_ITEM_CATEGORIES_V MIC, APPS.MTL_CATEGORIES_V MC
             WHERE MC.CATEGORY_ID = MIC.CATEGORY_ID
               AND MIC.CATEGORY_SET_NAME IN ('Inventory')) INVENTARIO
     WHERE fmd.line_type              = -1                   AND           
           fmd.formula_id             = fm.formula_id        AND
           fmd.organization_id        = fm.organization_id   AND
--           
           /**** performance ****/
           --vr.preference                  = 1               AND   
           vr.delete_mark                 = 0               AND   
           vr.recipe_use                  = 2               AND -- 0 = Produção - 2=Custos 
           vr.validity_rule_status       in (700,900)       AND 
           vr.recipe_id                   = gr.recipe_id    AND
           vr.start_date                 <= sysdate         AND
           vr.end_date                   is NULL            AND           
           /**** performance ****/
--           
           gr.recipe_id                 = (SELECT MAX(gr1.recipe_id)
                                             FROM   apps.gmd_recipes_b             gr1
                                                   ,apps.gmd_recipe_validity_rules vr1
                                                   ,apps.fm_matl_dtl               fmd1
                                             WHERE  vr1.delete_mark = 0
                                             AND    vr1.recipe_use = 2
                                             AND    vr1.validity_rule_status IN (700, 900)
                                             AND    vr1.start_date <= SYSDATE
                                             AND    vr1.end_date IS NULL
                                             AND    vr1.organization_id = fmd.organization_id
                                             AND    vr1.recipe_id = gr1.recipe_id
                                             AND    gr1.recipe_status IN (700, 900)
                                             AND    fmd1.line_type         = 1
                                             AND    fmd1.inventory_item_id = vr.inventory_item_id
                                             AND    gr1.formula_id = fmd1.formula_id) and
--                                                  
           gr.recipe_status            in (700,900)             AND
           gr.formula_id                = fm.formula_id         AND
--           
          -- NVL(fms.formula_class,'SM') <> 'TING-PMC'            AND
           fms.formula_id               = fm.formula_id         AND
           fm.line_type                 = 1                     AND
           fm.inventory_item_id         = msi.inventory_item_id AND
           fm.organization_id           = msi.organization_id   AND
           msip.inventory_item_id       = fmd.inventory_item_id AND
           msip.organization_id         = msi.organization_id   AND
           msip.segment1 <> msi.segment1 and
           -- MSI.SEGMENT1 = 'AK0001L.01'
           --           
           --
           MSI.ORGANIZATION_ID       = INVENTARIO.ORGANIZATION_ID AND
           MSI.INVENTORY_ITEM_ID     = INVENTARIO.INVENTORY_ITEM_ID AND
         --  MSI.item_type like 'ACA%' AND
           --INVENTARIO.CATEGORIA LIKE 'ACA%REF%' /*and
          -- 
         -- msi.segment1 = '102400L.20'
          --
          --
          (msi.segment1 in
       ('1037.01',
'1037.04',
'1100.01',
'1100.04',
'1128.01',
'1128.04',
'1132.01',
'1132.04',
'1134.01',
'1134.04',
'1141.01',
'1141.04',
'1144.01',
'1144.04',
'1149.01',
'1149.04',
'1154.01',
'1154.04',
'1155.01',
'1155.04',
'1156.01',
'1156.04',
'1157.01',
'1157.04',
'1159.01',
'1159.04',
'1162.01',
'1162.04',
'1164.01',
'1164.04',
'1166.01',
'1166.04',
'1170.01',
'1170.04',
'1172.01',
'1172.04',
'1174.01',
'1174.04',
'1179.01',
'1179.04',
'1180.01',
'1180.04',
'1181.01',
'1181.04',
'1182.01',
'1182.04',
'1183.01',
'1183.04',
'1184.01',
'1184.04',
'1199.01',
'1199.04',
'1299.01',
'1299.04',
'145.01',
'1501.01',
'1501.45',
'155.01',
'155.04',
'1600.80',
'16001.33',
'16002.33',
'1602.80',
'1603.80',
'1604.80',
'1605.80',
'1606.80',
'1607.80',
'1608.80',
'1609.80',
'1610.80',
'1611.80',
'1612.80',
'1613.80',
'1614.80',
'1615.80',
'1616.80',
'1617.80',
'1618.80',
'1619.80',
'1620.80',
'1630.80',
'1631.80',
'1632.80',
'1633.80',
'1634.80',
'1635.80',
'1636.80',
'1637.80',
'1650.80',
'1651.80',
'1660.80',
'1661.80',
'1662.80',
'1663.80',
'1664.80',
'1665.80',
'1800.01',
'1800.04',
'190.01',
'190.04',
'1900.01',
'1900.04',
'1945.01',
'1945.04',
'200.01',
'200.04',
'22002.03',
'22002.10',
'245.01',
'245.04',
'250.01',
'2500.01',
'2500.04',
'25110.01',
'25110.04',
'25110.45',
'26120.01',
'26120.04',
'288110.01',
'288110.45',
'3001.01',
'3001.45',
'3010.01',
'3010.45',
'30110.45',
'3012.01',
'3012.45',
'3017.01',
'3017.45',
'3028.01',
'3028.45',
'3036.01',
'3036.45',
'3038.01',
'3038.45',
'3043.01',
'3043.45',
'3044.01',
'3044.45',
'3044P.45',
'3046.01',
'3046.45',
'3046P.45',
'3047.01',
'3047.45',
'3048.01',
'3048.45',
'3049.01',
'3049.45',
'3051.01',
'3052.01',
'3052.45',
'3053.01',
'3053.45',
'30565.45',
'3058.01',
'3058.45',
'3062.01',
'3062.45',
'3066.01',
'3067.01',
'3067.45',
'3077.01',
'3077.45',
'3077P.45',
'3087.01',
'3087.45',
'3091.01',
'3091.45',
'3101.45',
'3201.01',
'3201.45',
'3202.01',
'3202.45',
'3203.01',
'3203.45',
'3205.01',
'3205.45',
'3206.01',
'3206.45',
'3207.01',
'3207.45',
'3414.01',
'3414.04',
'350.33',
'351.33',
'3565.50',
'3700.01',
'3700.45',
'372002.03',
'372002.10',
'388110.45',
'40687.45',
'4292.04',
'4400.01',
'44090.03',
'4680.26',
'4680.38',
'4686.01',
'4686.04',
'4686.45',
'4687.01',
'4687.50',
'49030.10',
'49030.50',
'5100.01',
'5100.04',
'5100.16',
'5132.01',
'5132.04',
'5134.01',
'5134.04',
'5141.01',
'5141.04',
'5144.01',
'5144.04',
'5144.16',
'5149.01',
'5149.04',
'5154.01',
'5154.04',
'5156.01',
'5156.04',
'5159.01',
'5159.04',
'5162.01',
'5162.04',
'5164.01',
'5164.04',
'5166.01',
'5166.04',
'5170.01',
'5170.04',
'5172.01',
'5172.04',
'5174.01',
'5174.04',
'5179.01',
'5179.04',
'5180.01',
'5180.04',
'5181.01',
'5181.04',
'5182.01',
'5182.04',
'5183.01',
'5183.04',
'5184.01',
'5184.04',
'5300.01',
'5300.04',
'5322.01',
'5322.04',
'5390.01',
'5390.04',
'5395.01',
'5395.04',
'5454.04',
'5457.01',
'605110.45',
'6400.01',
'6412.01',
'6600.01',
'6600.50',
'6602.45',
'6602.50',
'6605.01',
'6605.45',
'6609.01',
'6609.50',
'6612.01',
'6612.45',
'6612.50',
'6618.01',
'6618.45',
'6618.50',
'6647.01',
'6647.45',
'6647.50',
'692.01',
'692.45',
'692.50',
'7100.01',
'7100.45',
'7102.01',
'7102.45',
'7104.01',
'7104.45',
'7106.01',
'7106.45',
'7107.01',
'7107.45',
'7108.01',
'7108.45',
'7109.01',
'7109.45',
'7110.01',
'7110.45',
'7200.33',
'7300.33',
'7400.01',
'7400.04',
'7400.45',
'7405.01',
'7405.45',
'7412.01',
'7412.45',
'7418.01',
'7418.45',
'7424.01',
'7424.45',
'7462.01',
'7462.45',
'7465.01',
'7465.45',
'7470.01',
'7470.45',
'8002002.03',
'8724086.03',
'8918080.33',
'900.01',
'900.04',
'900.45',
'9062002.03',
'9217090.33',
'9247090.33',
'96-10.04',
'96-10.11',
'96-12.04',
'96-12.11',
'96-13.04',
'96-13.11',
'96-2.11',
'96-22.04',
'96-22.11',
'96-23.04',
'96-26.04',
'96-26.11',
'96-3.11',
'96-4.04',
'96-4.11',
'96-5.04',
'96-5.11',
'96-6.04',
'96-6.11',
'96-7.04',
'96-7.11',
'980.01',
'980.45',
'980.50',
'999.01',
'999.50',
'AM-BL.48',
'CA636.48',
'CF700B.68',
'CK611L.70',
'CP524.68',
'CP583D.73',
'CP619.23',
'CR681.68',
'CS100.68',
'DR4701.01',
'DR4701.04',
'DR4701.45',
'DR4701.52',
'DR4702.01',
'DR4702.45',
'DR4703.01',
'DR4703.45',
'DR4704.01',
'DR4704.45',
'DR4705.01',
'DR4705.45',
'DR4706.01',
'DR4706.45',
'DR4706.50',
'DR4708.01',
'DR4708.45',
'DR4708.50',
'DR4709.01',
'DR4709.45',
'DR4713.01',
'DR4713.45',
'DR4715.01',
'DR4715.45',
'DR4717.01',
'DR4717.45',
'DR4762.01',
'DR4762.45',
'DR4762.50',
'DR4780.01',
'DR4780.45',
'DR4780.50',
'DR4800.45',
'DR4844.45',
'DV4795.01',
'DV4795.04',
'DV4795.45',
'DV4795.50',
'DV5190.01',
'DV5190.04',
'DV7490.01',
'DV7490.04',
'DV7490.45',
'DV7491.01',
'DV7491.04',
'DV7491.45',
'DV7492.01',
'DV7492.04',
'DV7492.45',
'DV7492.50',
'DV7493.01',
'DV7493.04',
'DV7493.45',
'DV7493.50',
'I-00304.79',
'I-00323BR.57',
'I-00900.77',
'I-00902.50',
'INRA-00001.4P',
'INRB-00001.63',
'INRC-00006.57',
'INRC-00010.63',
'INRC-00012.57',
'INRD-00004.97',
'INRD-00015.97',
'INRO-00002.77',
'LT0001SDD.48',
'LT0001SDD.50',
'LT0002SSA.48',
'LT0002SSA.51',
'LT0302SSA.48',
'LT0306SSA.48',
'LT0326SSA.48',
'LT0408SSA.48',
'LT12020SSA.51',
'LT12021SSA.51',
'LT12200SSA.51',
'LT12202SSA.51',
'LT1453SDD.10',
'LT1453SDD.48',
'LT1453SDD.50',
'LT1462SDD.50',
'LT15034SSA.51',
'LT16071SSA.01',
'LT16073SSA.01',
'LT1927SDD.50',
'LT5718SDD.77',
'LT5729SDD.50',
'LT5750SDD.50',
'LT6913SSA.51',
'LT8886SSA.51',
'MJ6720.01',
'MJ6720.04',
'MJ6722.01',
'MJ6722.04',
'MJ6723.01',
'MJ6723.04',
'MJ6735.01',
'MJ6735.04',
'MJ6740.01',
'MJ6740.04',
'MJ6740.52',
'MJ6741.01',
'MJ6741.04',
'MJ6741.52',
'MJ6742.01',
'MJ6742.04',
'MJ6742.52',
'MJ6745.01',
'MJ6745.04',
'MJ6745.52',
'MJ6749.01',
'MJ6749.04',
'MJ6749.52',
'MJ6770.01',
'MJ6770.04',
'MJ6799.01',
'MJ6799.04',
'MJ6801.01',
'MJ6801.04',
'MJ6802.01',
'MJ6802.04',
'MJ6803.01',
'MJ6803.04',
'MJ6804.01',
'MJ6804.04',
'MJ6805.01',
'MJ6805.04',
'MJ6811.01',
'MJ6811.04',
'MJ6820.01',
'MJ6820.04',
'MJ6825.01',
'MJ6825.04',
'MJ6830.01',
'MJ6830.04',
'MJ6835.01',
'MJ6835.04',
'MJ6860.01',
'MJ6860.04',
'MJ6870.01',
'MJ6870.04',
'MJ6955.01',
'MJ6955.04',
'MJ7050.01',
'MJ7050.04',
'MZD7330.65',
'NA101JD.48',
'PCS1N-1125.4P',
'PCS1N-1138.4P',
'PCS1N-1147.4P',
'PCT1G-1084B.4P',
'PCT1G-3017B.4P',
'PCT1G-3028.4P',
'PCT1G-3036.4P',
'PCT1G-4522B.4P',
'PCT1G-4528.4P',
'PCT1G-4531.4P',
'PCT1N-0060.4P',
'PCT1N-1065.4P',
'PCT1N-1131.4P',
'PCT1N-1890.4P',
'PCT1N-1890F.4P',
'PHC.77',
'PIT3001.45',
'PIT3062.01',
'PIT3790.01',
'PIT3791.01',
'PIT3792.01',
'PIT3793.01',
'PIT3793.04',
'PIT3990.45',
'PIT3991.45',
'PIT3992.01',
'PIT3992.45',
'PIT3993.01',
'PIT3993.04',
'PIT3993.45',
'PIT4686.01',
'PIT4686.45',
'PIT4686.50',
'PIT4703.45',
'PIT4706.45',
'PIT4728.45',
'PIT4762.01',
'PIT5100.01',
'PIT5144.04',
'PIT6481.01',
'PIT6482.01',
'PIT6680.01',
'PIT7412.01',
'PIT900.01',
'PIT900.45',
'PIT999.01',
'PV3090.01',
'PV3090.45',
'RE1401.01',
'RE1401.45',
'RE1401.50',
'RE2701.01',
'RE2701.04',
'RE2901.01',
'RE2901.04',
'RE4301.01',
'RE4301.45',
'RE4301.50',
'RE6001.01',
'RE6001.45',
'RE6001.50',
'RE8801.01',
'RE8801.04',
'RE8801.45',
'RV1190.01',
'RV1190.04',
'RV1191.01',
'RV1191.04',
'RV1192.01',
'RV1192.04',
'RV1193.01',
'RV1193.04',
'RV1290.02',
'RV1293.02',
'RV1490.01',
'RV1490.04',
'RV1490.45',
'RV1491.01',
'RV1491.04',
'RV1491.45',
'RV1491.50',
'RV1492.01',
'RV1492.04',
'RV1492.45',
'RV1492.50',
'RV1493.01',
'RV1493.04',
'RV1493.45',
'RV1493.50',
'RV1590.01',
'RV1590.04',
'RV1590.45',
'RV1591.01',
'RV1591.04',
'RV1591.45',
'RV1592.01',
'RV1592.04',
'RV1592.45',
'RV1592.50',
'RV1593.01',
'RV1593.04',
'RV1593.45',
'RV1593.50',
'RV1892.01',
'RV1892.04',
'RV1893.01',
'RV1893.04',
'RV1992.01',
'RV1992.04',
'RV1993.01',
'RV1993.04',
'RV2590.01',
'RV2590.04',
'RV2591.01',
'RV2591.04',
'RV2592.01',
'RV2592.04',
'RV2593.01',
'RV2593.04',
'RV2790.01',
'RV2790.04',
'RV2990.01',
'RV2990.04',
'RV2991.01',
'RV2991.04',
'RV2992.01',
'RV2992.04',
'RV2993.01',
'RV2993.04',
'RV3300.01',
'RV3300.04',
'RV3300.45',
'RV3400.01',
'RV3400.04',
'RV3400.45',
'RV3520.04',
'RV3545.01',
'RV3545.45',
'RV3545.50',
'RV3555.45',
'RV3555.50',
'RV3560.01',
'RV3575.01',
'RV3575.45',
'RV3575.50',
'RV3600.01',
'RV3600.04',
'RV3600.45',
'RV3790.01',
'RV3790.04',
'RV3790.45',
'RV3791.01',
'RV3791.04',
'RV3791.45',
'RV3791.50',
'RV3792.01',
'RV3792.04',
'RV3792.45',
'RV3793.01',
'RV3793.04',
'RV3793.45',
'RV3793.50',
'RV3990.01',
'RV3990.04',
'RV3990.45',
'RV3991.01',
'RV3991.04',
'RV3991.45',
'RV3992.01',
'RV3992.04',
'RV3992.45',
'RV3993.01',
'RV3993.04',
'RV3993.45',
'RV4490.01',
'RV4491.01',
'RV4492.01',
'RV4493.01',
'RV6090.01',
'RV6090.45',
'RV6480.01',
'RV6480.04',
'RV6481.01',
'RV6481.04',
'RV6481.50',
'RV6482.01',
'RV6482.04',
'RV6482.45',
'RV6483.01',
'RV6483.04',
'RV6483.45',
'RV6483.50',
'RV6680.01',
'RV6680.04',
'RV6680.45',
'RV6680.50',
'RV6681.01',
'RV6681.04',
'RV6681.45',
'RV6681.50',
'RV6682.01',
'RV6682.04',
'RV6682.50',
'RV6683.01',
'RV6683.04',
'RV6683.45',
'RV6683.50',
'RV7090.01',
'RV7090.45',
'RV8870.01',
'RV8870.04',
'RV8870.45',
'RV8871.01',
'RV8871.04',
'RV8871.45',
'RV8872.01',
'RV8872.04',
'RV8872.45',
'RV8872.50',
'RV8873.01',
'RV8873.04',
'RV8873.45',
'TG140.37',
'TG200.37',
'TG300.37',
'UT32.68',
'UT92D.68',
'UT95WP.68',
'UY6200.45',
'UY988.01',
'UY988.45',
'102400L.20',
'102670L.10',
'106205.11',
'108309L.20',
'113191L.20',
'115352L.10',
'117246.11',
'119507L.10',
'121186L.10',
'135441.20',
'135443.20',
'136661.20',
'136664.10',
'138909.01',
'140725.20',
'141100L.01',
'141102L.20',
'141343L.20',
'141347L.20',
'142014L.10',
'144493LA.20',
'148999.01',
'1490001L.20',
'1490003L.20',
'149922L.20',
'149924L.20',
'153218.02',
'153221.02',
'153223.02',
'153225.02',
'153228.02',
'153234.02',
'153237.02',
'153975L.20',
'153979L.20',
'153983L.20',
'1540001L.20',
'1540003L.20',
'154011L.20',
'154017L.20',
'154019L.20',
'154020L.20',
'154022L.20',
'154023L.20',
'156610L.01',
'156612L.01',
'159337L.20',
'16610034L.39',
'16610073L.01',
'171568.20',
'171569.10',
'173175.20',
'191905.11',
'1TMC42453.48',
'202389L.10',
'202390L.20',
'2040001L.01',
'2040001L.20',
'2040003L.01',
'2040003L.20',
'204608L.20',
'204618L.20',
'204697.10',
'204698.10',
'204699.10',
'204700.10',
'204958.10',
'204960.10',
'204961.10',
'204962.10',
'204963.10',
'204965.10',
'204966.10',
'204967.10',
'204968.10',
'210339L.20',
'211282L.20',
'217621L.01',
'217622L.01',
'219188.20',
'219189.10',
'21980034L.16',
'21980076L.01',
'220294L.04',
'220294L.10',
'220295L.20',
'220297L.20',
'224096L.20',
'22880034L.04',
'22880078L.01',
'231302L.04',
'231302L.10',
'237059L.31',
'2380001L.20',
'2380003L.20',
'238754L.20',
'238759L.01',
'238847L.20',
'238849L.20',
'239969L.20',
'239981L.20',
'240471L.20',
'240476L.20',
'242083L.20',
'242611L.04',
'242620L.01',
'246840L.01',
'247810L.20',
'250040.20',
'250042.20',
'250044.01',
'250781L.20',
'250783L.20',
'250792L.20',
'26300004L.01',
'26300034L.04',
'267453.01',
'26800003L.01',
'26800004L.01',
'26800005L.01',
'26800018L.01',
'26800034L.04',
'26800063L.01',
'26800064L.01',
'269554L.01',
'269558L.01',
'279795L.20',
'288955L.01',
'299378L.20',
'299793L.20',
'316067L.20',
'316384.08',
'3180001L.20',
'3180003L.20',
'318046L.04',
'318046L.10',
'318204L.20',
'318205L.20',
'319653.01',
'32-0007.1Q',
'32-0009',
'321553.20',
'321554.20',
'323081.20',
'328959.20',
'332590L.20',
'365568.20',
'371224.20',
'371293.20',
'383930.01',
'4100004L.01',
'5200001L.01',
'5200003L.01',
'5200035L.01',
'5200036L.01',
'5500003L.01',
'5500004L.01',
'5500007L.01',
'5500019L.01',
'5500031L.04',
'5500037L.01',
'5500044L.01',
'5500045L.01',
'5500074L.20',
'5500080L.20',
'5500081L.01',
'5500083L.01',
'5500088L.01',
'5500157L.01',
'5580003L.20',
'5580034L.10',
'5900003L.01',
'5900004L.01',
'5900004L.20',
'5900006L.01',
'5900006L.20',
'5900007L.01',
'5900019L.01',
'5900032L.01',
'5900032L.20',
'5900034L.04',
'5900034L.10',
'5900043L.01',
'5900048L.01',
'5900049L.04',
'5900063L.01',
'5900064L.01',
'5900082L.01',
'5900083L.01',
'7900.L95',
'7949.T80',
'7957.L95',
'8-3538.1G',
'8800003L.01',
'8800023L.20',
'8800026L.20',
'8800118L.20',
'99910006.22',
'A-R126181.22',
'A-R520024.22',
'A-R520517.22',
'A-R520685.22',
'A-R531029.22',
'A242.15',
'A400.20',
'A400.48',
'A652.18',
'A722.18',
'A722.28',
'AG-0001BR.01',
'AK-0AL.01',
'AK-0BL.01',
'AK00043L.01',
'AK2-0004L.01',
'AK2-0005L.01',
'AK2-23L.20',
'AK2-BL.01',
'AK2-BL.20',
'AK2-T1L.01',
'AK2-T2L.01',
'AK2-T3L.01',
'AM-0102L.20',
'AM-BL.10',
'AM-BL.20',
'APBB-00003.51',
'APBB-00020.51',
'APBC-00007.51',
'APBC-00009.51',
'APBC-00010.51',
'APBC-00011.51',
'APBC-00017.51',
'APBC-00018.51',
'APBD-00001.51',
'APBD-00002.51',
'APBD-00006.51',
'APBD-00011.51',
'APBD-00014.51',
'AT285-0004L.01',
'AT285-0004L.20',
'AT285-112L.01',
'AT285-BL.01',
'AT285-BL.20',
'AT385HS-003L.01',
'AT385HS-004L.01',
'AT385HS-040L.01',
'AT385HS-063L.01',
'AT385HS-064L.01',
'AT385HS-112L.01',
'AT385HS-BL.01') OR
msi.segment1 in ('AT450-BL.10',
'AT68G-BL.10',
'AT68GL.20',
'AT765.10',
'BMHA-00001.22',
'BMHA-00003.22',
'BMHC-00001.22',
'BMHC-00002.22',
'BMPC-00002.22',
'BMPE-00002.22',
'BMPE-00003.22',
'BMSB-00002.22',
'BMSB-00003.22',
'BMVC-00001.22',
'BN-01.01',
'BP-01.01',
'BP-01.20',
'BP-04.01',
'BP-05.01',
'BP-06.01',
'BS-01.01',
'BS-02.11',
'BS-04.01',
'BTC-1000.01',
'BU-02.01',
'BU-04.01',
'C083-4090.04',
'C084-6419.01',
'C084-6419.04',
'C086-6405.01',
'C086-6405.04',
'C190-0900.11',
'C190-0950.04',
'C190-0970.04',
'C190-0998.04',
'C190-1021.04',
'C190-1021.08',
'C190-1021.11',
'C190-1051.04',
'C190-3068.04',
'C210-0010.02',
'C210-0010.11',
'C210-0010.32',
'C210-0020.02',
'C210-0020.11',
'C210-0020.32',
'C210-0901.32',
'C210-0951.32',
'C210-0999.32',
'C210-1052.32',
'C210-3019.32',
'C210-3087.02',
'C210-3087.16',
'C210-3504.32',
'C271-0100.04',
'C275-3123.16',
'C551-9446.17',
'C551-9446.28',
'C551-9800.17',
'C562-1141.04',
'C562-1142.01',
'C562-1142.04',
'C562-1143.06',
'C562-1150.17',
'C565-0981.04',
'C565-1051.04',
'C565-6121.04',
'C565-6122.04',
'C565-7040.01',
'C565-7040.04',
'C565-7041.01',
'C565-7041.04',
'C850-0101.51',
'C850-0600.04',
'C850-0600.10',
'C850-0900.04',
'C850-0900.10',
'C850-1100.04',
'C850-3800.04',
'C850-3800.10',
'C850-5000.11',
'C950-9441.04',
'CA708B.70',
'CF51HD.68',
'CG-1482S.11',
'CK166M.68',
'CK171-11.97',
'CL-500.01',
'CL-502.11',
'CL-510.11',
'CL-512.11',
'CL-513.11',
'CL-517.11',
'CL-530.11',
'CL-531.11',
'CL-533.11',
'CL-535.11',
'CL-537.11',
'CL-539.11',
'CL-542.11',
'CL-544.11',
'CL-546.11',
'CL-548.11',
'CL-549.11',
'CL-550.11',
'CL-551.11',
'CL-553.11',
'CL-554.11',
'CL-555.11',
'CL-556.11',
'CL-559.11',
'CL-560.11',
'CL-561.11',
'CLTD-00001.10',
'CM-001.11',
'CM-002.01',
'CM-003.11',
'CM-007.11',
'CM-008.11',
'CM-010.11',
'CM-011.11',
'CM-015.11',
'CM-016.11',
'CM-017.11',
'CM-019.11',
'CM-031.11',
'CM-033.11',
'CM-035.11',
'CM-038.11',
'CM-040.11',
'CM-042.11',
'CM-043.11',
'CM-050.11',
'CM-060.11',
'CM-062.11',
'CM-063.11',
'CM-064.11',
'CM-065.11',
'CM-068.11',
'CM-069.11',
'CM-070.11',
'CM-071.11',
'CM-073.11',
'CM-074.11',
'CM-075.11',
'CM-076.11',
'CM-077.11',
'CM-078.11',
'CM-100.01',
'CM-102.01',
'CM-103.11',
'CM-105.11',
'CM-106.11',
'CM-107.11',
'CM-108.11',
'CM-110.11',
'CM-112.11',
'CM-116.11',
'CM-117.11',
'CM-118.11',
'CM-200.11',
'CM-201.11',
'CM-202.11',
'CM-203.11',
'CM-204.11',
'CM-205.11',
'CM-206.11',
'CM-207.11',
'CM-209.11',
'CM-212.11',
'CM-213.11',
'CM-214.11',
'CMPP3700A.22',
'COEA-00006.79',
'COEB-00001.48',
'COEB-00002.22',
'COEB-00003.79',
'COEB-00006.77',
'COEE-00004.57',
'COR1777.79',
'CP508B.73',
'CP524.79',
'CP524DG.79',
'CP639J.79',
'CPN-203.04',
'CPN-204.04',
'CPP-101.04',
'CPP-102.04',
'CPP-103.04',
'CPP-104.04',
'CPP-108.04',
'CPP-109.04',
'CPP-201.04',
'CPP-202.04',
'CPP-203.04',
'CPP-205.04',
'CPP-206.04',
'CPP-207.04',
'CPP-305.04',
'CPP-308.04',
'CPP-309.04',
'CPP-315.04',
'CPP-316.04',
'CPP-318.04',
'CPP-320.04',
'CPP-321.04',
'CPP-324.04',
'CPP-325.04',
'CPP-326.04',
'CPP-327.04',
'CPP-328.04',
'CPP-330.04',
'CPP-350.04',
'CPP-352.04',
'CPP-701.04',
'CPP-703.04',
'CR-303.11',
'CR-309.11',
'CR-311.11',
'CR-315.11',
'CR-332.11',
'CR-338.11',
'CR-377.11',
'CR659BR.23',
'CR935.57',
'CS100.77',
'CX-10.3B',
'CX-11.3B',
'CX-12.3B',
'CX-13.3B',
'CX-14.3B',
'D700.01',
'D701.01',
'D702.11',
'D703.01',
'D704.01',
'D710.11',
'D711.11',
'D717.11',
'D718.11',
'D719.11',
'D721.11',
'D723.11',
'D728.11',
'D729.11',
'D732.11',
'D734.11',
'D740.01',
'D741.11',
'D744.11',
'D746.11',
'D748.11',
'D749.11',
'D750.11',
'D751.11',
'D752.11',
'D753.01',
'D754.11',
'D756.11',
'D757.11',
'D759.11',
'D760.11',
'D761.11',
'D762.11',
'D763.11',
'D764.11',
'D765.11',
'D767.11',
'D768.11',
'D769.11',
'D770.01',
'D771.01',
'D772.01',
'D776.11',
'D777.11',
'D778.11',
'D779.11',
'D780.11',
'D785.11',
'D787.11',
'D788.11',
'D789.01',
'D790.11',
'D792.11',
'D793.11',
'D794.11',
'D797.11',
'D800.10',
'D800.11',
'D800.20',
'D800N.10',
'D8010.01',
'D8015.01',
'D8017.01',
'D803.11',
'D807.04',
'D807.10',
'D807.20',
'D807N.20',
'D8115.11',
'D8117.11',
'D812.04',
'D8120.10',
'D8175.10',
'D8186.11',
'D8221.06',
'D8238.06',
'D8260.06',
'D8305.12',
'D832.11',
'D837.04',
'D837.10',
'D839.01',
'D839.11',
'D839.20',
'D8401.65',
'D841.11',
'D8416.80',
'D8420.80',
'D8421.80',
'D8426.80',
'D8430.11',
'D8448.11',
'D8501.11',
'D8505.01',
'D8507.11',
'D851.04',
'D854.11',
'D863.11',
'D868.04',
'D868N.04',
'D8731.80',
'D8745.11',
'D8746.11',
'D895.11',
'D9020.3D',
'D9021.3D',
'D9022.3D',
'D9023.3D',
'D9037.3D',
'D9070.11',
'D942.11',
'D943.11',
'D944.11',
'D945.11',
'D946.01',
'D947.11',
'D952.01',
'D953.11',
'D954.11',
'D955.11',
'D956.11',
'D957.11',
'D958.11',
'D959.11',
'D960.11',
'D964.11',
'D965.11',
'D966.11',
'D967.11',
'D968.11',
'D969.11',
'D970.11',
'D971.11',
'D973.11',
'D976.11',
'D977.11',
'D978.11',
'D979.11',
'D980.11',
'D981.11',
'D983.11',
'D985.11',
'D989.11',
'D990.11',
'D991.11',
'DC2000.08',
'DC2000.11',
'DC3000.11',
'DC3000.20',
'DC4000.11',
'DC4000.20',
'DCH2015.04',
'DCH2015.16',
'DCH3070.11',
'DCH3085.11',
'DCH3095.11',
'DUL1800.17',
'DUL1800.18',
'DUL1800.28',
'EDADDWETT.65',
'F300.01',
'F300.20',
'F301.01',
'F302.01',
'F304.01',
'F305.01',
'F306.01',
'F308.01',
'F309.01',
'F311.01',
'F312.01',
'F313.01',
'F314.01',
'F315.01',
'F317.01',
'F318.01',
'F319.01',
'F320.01',
'F321.01',
'F323.01',
'F324.01',
'F325.01',
'F341.10',
'F341.20',
'F342.01',
'F349.11',
'F351.10',
'F359.11',
'F361.10',
'F361.11',
'F361.16',
'F362.11',
'F363.11',
'F366.11',
'F369.10',
'F371.10',
'F372.04',
'F372.10',
'F372.20',
'F372.48',
'F373.10',
'F373.20',
'F380.05',
'F381.11',
'F385.11',
'F390.05',
'F391.01',
'F392.01',
'F399.01',
'F420.10',
'F420.20',
'F420.48',
'F421.01',
'F421.20',
'FBR004.10',
'FBR004.11',
'FBR011.10',
'FBR017.10',
'FBR029.01',
'FBR030.01',
'FBR031.01',
'FBR100.20',
'FBR133.20',
'FBR133.48',
'FBR186.01',
'FBR197.01',
'FBR197.20',
'FBR331.01',
'FBR333.01',
'FBR334.01',
'FBR337.01',
'FBR375.20',
'FBR427.01',
'FBR455.20',
'FBR505.20',
'FBR506.77',
'FBR507.20',
'FBR512.20',
'FBR515.20',
'FBR516.77',
'FBR519.48',
'FBR520.48',
'FBR521.10',
'FBR522.77',
'FBR525.20',
'FBR525.48',
'FBR527.01',
'FBR532.20',
'FBR533.20',
'FBR551.20',
'FBR560.11',
'FBR572.10',
'FBR705.01',
'FBR710.20',
'FBR710.48',
'FBR711.48',
'FBR713.20',
'FBR911.20',
'FBR912.20',
'FBR913.48',
'FD.77',
'FIEA-00019.57',
'FIEA-00020.59',
'FIEB-00002.22',
'FIEB-00004.S5',
'FIEB-00005.22',
'FIEB-00007.57',
'FIEE-00008.57',
'FIHB-00006.22',
'FIHC-00001.22',
'FIMI-00002.22',
'FIPC-00001.B4',
'FIPC-00002.22',
'FIRA-00002.22',
'FIRB-00002.22',
'FIRC-00012.22',
'FISA-00001.22',
'FISB-00002.22',
'FISB-00003.22',
'GXM58021.22',
'HYEA-00002.59',
'HYEB-00001.S5',
'HYEB-00002.79',
'HYEB-00003.97',
'HYEB-00004.40',
'HYEE-00002.57',
'HYRA-00001.K20',
'HYRC-00001.57',
'HYRC-00003.57',
'HYRC-00004.57',
'HYRC-00005.97',
'HYRC-00006.97',
'HYRC-00007.97',
'HYRC-00008.57',
'HYRC-00009.97',
'HYRD-00001.57',
'HYRD-00002.57',
'I-00323BR.79',
'I-00900.63',
'I-00902.48',
'I-00911.S5',
'I-W533C998.51',
'IN501.01',
'IN502.01',
'IN506.01',
'IN507.01',
'IN509.01',
'IN512.01',
'IN512.48',
'IN518.01',
'IN600.01',
'IN601.11',
'INRC-00001.57',
'INRC-00003.63',
'INRC-00005.97',
'INRC-00006.97',
'INRD-00008.57',
'INRD-00008.77',
'INRD-00014.57',
'INRD-00014.97',
'INRO-00001.97',
'INRO-00002.63',
'INSP-00002.97',
'INSP-00003.50',
'IVBB-00008.48',
'IVBB-00011.51',
'IVBB-00014.48',
'IVBB-00015.51',
'IVBC-00002.51',
'IVEA-00004.59',
'IVEB-00001.T8',
'IVEB-00002.79',
'IVEB-00004.6A',
'IVEE-00003.22',
'IVPA-00001.48',
'IVRA-00001.22',
'IVRC-00002.63',
'IVRC-00003.57',
'IVRC-00006.63',
'IVRC-00007.63',
'IVRC-00008.63',
'IVRC-00009.97',
'IVRD-00002.63',
'IVRD-00003.57',
'IVRO-00002.97',
'IVSA-00002.48',
'IVSA-00003.C8',
'IVSA-00004.48',
'IVSA-00011.10',
'IVSB-00001.65',
'IVTB-00008.C25',
'IVTB-00017.51',
'IVTB-00025.51',
'IVTB-00027.51',
'IVTB-00047.48',
'IVTD-00005.01',
'IVTD-00007.01',
'IVTD-00015.01',
'IVTD-00018.01',
'IVTD-00019.01',
'IVTD-00022.01',
'IVTD-00035.01',
'IVTD-00042.01',
'IVTD-00045.01',
'IVTD-00048.01',
'IVTD-00049.01',
'IVTD-00050.01',
'IVTD-00060.01',
'IVVB-00002.48',
'LAC-5090FM.22',
'LG6137SIO.48',
'LG9916SSO.48',
'LT0044SSO.48',
'LT0045SSA.51',
'LT0082SSA.01',
'LT0082SSA.51',
'LT0303SSA.48',
'LT0330SSA.48',
'LT0408SSA.20',
'LT0450SSA.48',
'LT11002SDD.50',
'LT13001SSA-D.51',
'LT13002SSA-A.51',
'LT13004SSA-A.51',
'LT13005SSA-A.51',
'LT13006SSA-A.51',
'LT13007SSA.51',
'LT13013SSA.51',
'LT13014SSA.48',
'LT13014SSA.51',
'LT13015SSA.51',
'LT13030SSA.01',
'LT13030SSA.51',
'LT13030SSA.C4',
'LT13106SSA.51',
'LT13201SSA.51',
'LT13201SSA.C5',
'LT13230SSA.01',
'LT1367SDD.10',
'LT1367SDD.50',
'LT14170SSA.51',
'LT14177SSA.51',
'LT14230SSA.48',
'LT14230SSA.51',
'LT14231SSA.48',
'LT14231SSA.51',
'LT14232SSA.51',
'LT1462SDD.48',
'LT1491SDD.48',
'LT15015SSO.48',
'LT15015SSO.51',
'LT15016SSO.48',
'LT15016SSO.51',
'LT15017SSO.48',
'LT15017SSO.51',
'LT15019SSA.48',
'LT15019SSA.51',
'LT15032SSA.48',
'LT15032SSA.51',
'LT15033SSA.48',
'LT15033SSA.51',
'LT15106SSA.51',
'LT15290SSA.48',
'LT15290SSA.51',
'LT15307SSA.48',
'LT15307SSA.51',
'LT15503SSA.48',
'LT15503SSA.51',
'LT15803SSA.01',
'LT15803SSA.51',
'LT16070SSA.01',
'LT16071SSA-B.48',
'LT16073SSA.51',
'LT16075SSA.51',
'LT16077SSA.51',
'LT16080SSA.51',
'LT16200SSA.48',
'LT16200SSA.51',
'LT16456SSA.51',
'LT1669SDD.50',
'LT1938SDD.51',
'LT1965SDD.10',
'LT5728SDD.50',
'LT5730SDD-A.48',
'LT5731SDD.10',
'LT5750SDD.48',
'LT5751SDD.65',
'LT5845SSO.51',
'LT6003SSA-B.48',
'LT6500SSA.51',
'LT6906SSA.51',
'LT6939SSA.51',
'LT7098SSA.51',
'LT7274BRSSA.51',
'LT8840SSA.51',
'LT8853SSA.51',
'LT8867SSA.51',
'LT8909SSA.51',
'LT917954BRSSA.51',
'LT932767BRSSA.51',
'MBEA-00001.59',
'MBEB-00002.K18',
'MBEB-00004.K18',
'MBEB-00006.S5',
'MBEB-00007.97',
'MBEB-00008.K20',
'MBEE-00001.58',
'MBRD-00001.22',
'MBRD-00001.58',
'MBRD-00002.58',
'MBRD-00003.58',
'MBRD-00004.58',
'MBRD-00004.70',
'MBRD-00005.58',
'MBRD-00008.58',
'MBRZ-00001.71',
'MBRZ-00002.71',
'MBRZ-00003.71',
'MBRZ-00004.22',
'MBRZ-00005.58',
'MBRZ-00006.58',
'MBRZ-00007.71',
'MBRZ-00008.74',
'MBRZ-00009.71',
'MBRZ-00015.58',
'MBTD-00012.01',
'MEHA-00001.48',
'MEHA-00001.AMOSTRA',
'MEHA-00002.48',
'MEHA-00002.K18',
'MEHA-00003.48',
'MEHA-00004.48',
'MEHA-00006.48',
'MEHA-00006.K18',
'MEHA-00008.48',
'MEHB-00002.48',
'MEHB-00003.48',
'MEHC-00001.AMOSTRA',
'MEHC-00003.K21',
'MEPE-00001.48',
'MEPE-00002.48',
'MEPE-00002.AMOSTRA',
'MEPE-00003.48',
'MEPE-00003.AMOSTRA',
'MESA-00001.K80',
'MESA-00002.K80',
'MESA-00005.22',
'MESB-00001.72',
'MEVC-00001.K95',
'MNTB-00001.46',
'NG-1446S',
'NIAP-00001.22',
'NIBB-00005.22',
'NIBB-00006.22',
'NIBB-00007.22',
'NIBB-00008.22',
'NIBB-00009.22',
'NIBC-00010.22',
'NIBC-00011.22',
'NIBC-00012.22',
'NIBC-00013.22',
'NIBC-00014.22',
'NIBC-00015.22',
'NIBD-00003.22',
'NIBD-00004.22',
'NIBD-00005.22',
'NIEA-00001.22',
'NIEB-00001.22',
'NIEB-00002.22',
'NIEB-00003.22',
'NIEB-00005.22',
'NIEE-00002.22',
'NIHA-00001.22',
'NIHA-00002.22',
'NIHA-00003.22',
'NIHB-00001.22',
'NIHB-00002.22',
'NIHB-00003.22',
'NIHB-00004.22',
'NIHB-00005.22',
'NIHB-00007.22',
'NIHC-00001.22',
'NIHC-00002.22',
'NIHC-00003.22',
'NIHC-00005.22',
'NIHP-00001.22',
'NIHP-00002.22',
'NIPC-00001.22',
'NIRA-00001.22',
'NIRC-00002.22',
'NIRC-00003.22',
'NIRC-00005.22',
'NIRC-00006.22',
'NIRC-00008.22',
'NIRD-00001.22',
'NIRD-00002.22',
'NIRD-00003.22',
'NISA-00001.22',
'NISA-00002.22',
'NISA-00005.22',
'NISA-00010.22',
'NISA-T6000.22',
'NISB-00002.22',
'NISB-00003.22',
'NISB-00004.22',
'NITD-00001.22',
'NIVA-00002.22',
'NIVA-00003.22',
'NLSA-00001.22',
'NU126-0004L.01',
'NU126-BL.01',
'OTRA-00001.S5',
'OTRC-00001.57',
'OTRC-00002.63',
'OTRD-00004.57',
'P433-XR10.3B',
'PALA-00009.47',
'PALA-00010.47',
'PALA-000118.05',
'PALA-000118.47',
'PALA-00013.22',
'PALA-00018.48',
'PALA-00028.05',
'PALA-00102.47',
'PALA-00114.05',
'PALA-00119.51',
'PALA-00124.22',
'PALA-00129.22',
'PCF0N-2015.4P',
'PCF6G-1491.4P',
'PCF6G-1991.4P',
'PCF70283',
'PCF7G-0038B.4P',
'PCF7G-0087.9P',
'PCF7G-0087M.4P',
'PCF7G-0087S.9P',
'PCF7G-0129.4P',
'PCF7N-0157.4P',
'PCF7N-1149.4P',
'PCF7N-1180.4P',
'PCF7N-1181.4P',
'PCF7N-1391.4P',
'PCF7N-1391T.4P',
'PCF7N-1692.4P',
'PCF7N-8020.4P',
'PCF7N-8035.4P',
'PCF7N-8071.4P',
'PCF7P-1161.4P',
'PCF7P-1161S.4P',
'PCF7T-1179.4P',
'PCM1G-1215.4P',
'PCM1G-8029.4P'
) OR
msi.segment1 in ('PCM1N-8014.4P',
'PCM3N-96010.4P',
'PCS1G-1174.4P',
'PCS1G-4537.4P',
'PCS1N-1036.4P',
'PCS1N-1077.4P',
'PCS1N-1143.4P',
'PCS1N-1150.4P',
'PCS1N-3015.4P',
'PCS1N-3034.4P',
'PCS1N-8006.4P',
'PCS1N-8040.4P',
'PCS1N-8044.4P',
'PCT1G-1064B.4P',
'PCT1G-1100.4P',
'PCT1G-1134.4P',
'PCT1G-1144.4P',
'PCT1G-3021.4P',
'PCT1G-3032.4P',
'PCT1G-3033.4P',
'PCT1G-4533.4P',
'PCT1G-5053.4P',
'PCT1G-6041.4P',
'PCT1G-8033.4P',
'PCT1K-1043.4P',
'PCT1K-1117.4P',
'PCT1N-1822.4P',
'PCT1N-1823.4P',
'PCT1N-1891.4P',
'PCT1N-8000.4P',
'PCT1N-8024B.4P',
'PCT1N-8038.4P',
'PCT1P-9001.4P',
'PCT39149',
'PCT99125',
'PCTT70135',
'PCTT70196',
'PCTZ39104',
'PPG-3402.04',
'PPG-6402.04',
'PPG-818.04',
'PPG-9305.04',
'PPG0122-801A.51',
'PPG2004-398A.49',
'PPG2004-846A.T92',
'PPG2066-813A.T90',
'PPG2092-683A.49',
'PPG2092-684A.49',
'PPG2092-821A.T92',
'PPG2092-825A.49',
'PPG2238-899A.52',
'PPG2463-303A.B94',
'PPG2463-803A.T92',
'PPG2497-303B.52',
'PPG2521-302.53',
'PPG2521-602.53',
'PPG2541-302A.B96',
'PPG2541-303A.B96',
'PPG2541-305A.52',
'PPG2613-810A.49',
'PPG2658-201A.49',
'PPG2845-801B.22',
'PPG2845-801C.52',
'PPG2953-301A.T92',
'PPG2953-302A.T92',
'PPG2953-304A.49',
'PPG2954-803A.T90',
'PPG2954-806A.49',
'PPG2954-807A.49',
'PPG2970-808A.T90',
'PPG2987-804B.B94',
'PPG2987-805B.B94',
'PPG3109-801A.B94',
'PPG3190-810A.T90',
'PPG3586-601/A',
'PPG3825-803.C6',
'PPG3901-401/A.22',
'PPG4014-601A.B98',
'PPG4670-008A.52',
'PPG4670-008A.53',
'PPG4670-009A.52',
'PPG4681-801.49',
'PPG4681-801.52',
'PPG4695-805A.52',
'PPG4699-803.52',
'PPG4880-301A.52',
'PPG5039-305/A',
'PPG5153-801A.49',
'PPG5153-801A.52',
'PPG5156-805.49',
'PPG5156-805.52',
'PPG7940-303B.57',
'PPG7940-309A.52',
'PPG8460-302A.52',
'PPG8460-303A.52',
'PPG8900-302B.52',
'PPG9201-809A.C6',
'PPG9201-811B.53',
'PPG9201-813.C6',
'PPG9201-815.C6',
'PPG9201-821B.53',
'PPG9203-802.C6',
'PPPL-1000.51',
'PRLX2.3A',
'PRLX3.3A',
'PRLX4.3A',
'PRLX5.3A',
'PRLX6.3A',
'PRLX7.3A',
'PRLX8.3A',
'PRLX9.3A',
'PT52107-08.68',
'PT72868-20.T80',
'Q001400353-C4',
'R89712162.01',
'RCEB-00002.22',
'RCEB-00011.22',
'RCEB-00015.22',
'RCPB-00006.22',
'RCSA-00004.22',
'RCSA-00006.22',
'RCSA-00008.22',
'RCSA-00043.22',
'RCVA-00002.22',
'REBC-00003.22',
'REBD-00002.22',
'REBD-00003.22',
'REBD-00004.22',
'REHA-00011.22',
'REHA-00016.22',
'REHB-00004.22',
'RESA-00001.22',
'RESB-00001.22',
'REVA-00002.22',
'REVA-00003.22',
'RR73B.77',
'SK-66-6714',
'SL010.11',
'SL020.11',
'SL100.01',
'SL200.08',
'SL500.11',
'SPR51134-ZL.80',
'SPTS-00006.97',
'SPTS-00008.97',
'SPTS-00034.97',
'SPTS-00036.63',
'SPTS-00037.22',
'SPTS-00038.22',
'SPTS-00040.97',
'T400.63',
'T4000.66',
'T4001.66',
'T4002.66',
'T4003.66',
'T4004.66',
'T4005.66',
'T4006.66',
'T4007.16',
'T4008.16',
'T4018.16',
'T402.66',
'T4020.66',
'T4021.66',
'T4022.66',
'T4023.66',
'T4024.66',
'T4025.66',
'T4026.66',
'T403.66',
'T4031.16',
'T4032.16',
'T4033.16',
'T4034.16',
'T4035.16',
'T4037.16',
'T404.66',
'T4040.66',
'T4042.66',
'T405.66',
'T406.75',
'T407.63',
'T409.63',
'T411.75',
'T412.75',
'T413.75',
'T414.63',
'T415.66',
'T420.75',
'T421.66',
'T422.66',
'T423.66',
'T425.66',
'T426.66',
'T427.75',
'T4281.66',
'T429.66',
'T430.75',
'T431.75',
'T4311.66',
'T432.75',
'T4321.66',
'T433.66',
'T4341.66',
'T4342.66',
'T4343.66',
'T435.75',
'T436.66',
'T438.75',
'T440.66',
'T441.66',
'T442.66',
'T443.75',
'T444.75',
'T445.66',
'T447.75',
'T448.75',
'T451.66',
'T452.66',
'T453.75',
'T454.75',
'T455.66',
'T456.75',
'T457.66',
'T458.66',
'T459.75',
'T460.66',
'T461.66',
'T462.75',
'T465.66',
'T466.66',
'T468.66',
'T4705.66',
'T471.63',
'T472.63',
'T473.63',
'T474.75',
'T475.63',
'T476.63',
'T477.75',
'T479.75',
'T489.66',
'T490.75',
'T491.75',
'T492.75',
'T494.63',
'T497.65',
'T499.74',
'T510.75',
'TF019.04',
'TF1101.04',
'TF1102.04',
'TF1201.04',
'TF1203.04',
'TF517.01',
'TF822.04',
'TG-0938.52',
'TG-0940.52',
'TG-0962.L95',
'TG-0965.50',
'TG-1512.52',
'TG-1516.52',
'TKU2000C.51',
'TOBB-00010.46',
'TOBB-00011.51',
'TOBB-00014.51',
'TOBB-00016.51',
'TOBB-1D6MZ.51',
'TOBB-1K3MI.51',
'TOBC-070MI.51',
'TOBC-070MIN.51',
'TOBC-070SI.51',
'TOBC-070SIN.51',
'TOBC-3R3MI.51',
'TOBC-3R3SI.01',
'TOBC-4W9MI.51',
'TOBC-4W9SI.01',
'TOBD-00003.51',
'TOBD-00004.51',
'TOBD-070MI.51',
'TOBD-070MIN.51',
'TOBD-070MZ.51',
'TOEA-00007.73',
'TOEA-6247S.73',
'TOEA-6356I.57',
'TOEA-6356Z.57',
'TOEB-00001.48',
'TOEB-00001.50',
'TOEB-00006.97',
'TOEB-00010.S5',
'TOEB-00011.97',
'TOEB-00012.65',
'TOEB-00013.65',
'TOEE-6176B.C6',
'TOEE-6176K.C6',
'TOEE-6355IN.C6',
'TOEE-6355Z.C6',
'TOHA-1E7WK7.51',
'TOHA-1F2WK.51',
'TOHA-1G2WK.51',
'TOHA-1G2WS.T91',
'TOHA-1H6WK.51',
'TOHA-1H6WS.T91',
'TOHA-1K1WK.51',
'TOHA-1K1WS.T91',
'TOHA-1K3WK7.51',
'TOHB-070WK3.51',
'TOHB-070WS.T91',
'TOHB-209WK7.51',
'TOHB-215WK.51',
'TOHB-215WS.T91',
'TOHB-3R3WK7.51',
'TOHB-4W9WK7.51',
'TOHB-8V5WK3.51',
'TOHB-8V5WS3.51',
'TOHC-040WK3.51',
'TOHC-040WS3.T91',
'TOHC-070WK4.51',
'TOHC-070WS.T91',
'TOHC-3P0WK7.51',
'TOHC-3P0WS7.51',
'TOHC-3P0WS7.T91',
'TOHC-AJ9WK4.51',
'TOHC-AK0WK4.51',
'TOPB-00015.46',
'TOPB-00016.51',
'TOPB-00017.51',
'TOPB-070BI.46',
'TOPB-070PZ.46',
'TOPC-00001.01',
'TOPC-00008.01',
'TOPC-00009.01',
'TOPC-070SI.51',
'TOPC-070SZ.51',
'TOPC-3300C.51',
'TOPC-3300N.51',
'TOPC-33ARN.51',
'TOPC-7018IN.51',
'TOPC-AJ3WK.51',
'TOPC-AK0WK.51',
'TOPC-AK3WK8.51',
'TOPC-LPP1SO.01',
'TOPD-503WS.T91',
'TOPD-7018S.T91',
'TOPD-8007S5.T91',
'TOPD-8106S5.T91',
'TORD-00003.77',
'TOSA-00017.48',
'TOSA-00023.48',
'TOSA-00025.48',
'TOSA-00027.48',
'TOSA-00029.48',
'TOSA-00031.48',
'TOSA-00033.48',
'TOSA-00033.51',
'TOSA-00034.50',
'TOSA-00035.50',
'TOSA-00037.50',
'TOSA-00044.10',
'TOSA-00045.10',
'TOSA-00046.10',
'TOSA-00054.50',
'TOSA-1210S.48',
'TOSA-7172K.51',
'TOSA-LPP1SO.10',
'TOSA-NK53KC.51',
'TOSA-NK53SC.51',
'TOSA-SD60K.51',
'TOSA-SD60S.51',
'TOSA-TSS3K.48',
'TOSB-00001.38',
'TOSB-00003.11',
'TOSB-500TL.10',
'TOSB-500TL.51',
'TOSB-6100K.51',
'TOTB-00019.51',
'TOTB-00020.T25',
'TOTB-M338I.51',
'TOVA-00007.51',
'TOVA-00008.46',
'TOVA-00010.51',
'TOVA-00016.48',
'TOVA-00017.10',
'TOVA-7172K.51',
'TOZA-00014.04',
'TOZA-00070.04',
'TOZA-00072.04',
'TOZA-00074.04',
'TOZA-070BP.04',
'TOZA-070MC.04',
'TOZA-070RP.04',
'TOZA-070RS.04',
'TOZA-1G2RS.04',
'TOZA-1H6RS.04',
'TOZA-1K1RS.04',
'TOZA-215RS.04',
'TOZA-3P0RS.04',
'TOZA-3R3BP.04',
'TOZA-4W9BP.04',
'TOZA-8V5RS.04',
'UDM95566B.51',
'UGA.70',
'UT32.70',
'VM4350.3A',
'VWBC-00006.23',
'VWHA-00012.22',
'VWHB-00004.22',
'VWHB-00016.23',
'VWHB-00017.23',
'VWHC-00006.22',
'WEP94000.22',
'XB16018B.52',
'ZB4200DM.97',
'ZB4200DR.97',
'ZB4200SR.68'))
           --
           --msi.segment1 = '8201144982.99' --'TOEA-6247Z.79' --'8201144996.99' --'8201540330.99' --'TOEA-6247Z.79'
           --msi.inventory_item_id        = 2701
--           
--
    UNION ALL
--    
    -- Parte RECURSIVA
--
--
    SELECT c.segment1,
           fmdi.inventory_item_id,
-- * (1 + (vr.planned_process_loss / 100))    
           case 
              when fmdi.scale_type = 0 then
                 ((fmdi.qty / fmi.qty) / vri.std_qty) * c.qty
              when fmdi.scale_type = 1 then
                 (fmdi.qty / fmi.qty) * c.qty
              else
                 (fmdi.qty / fmi.qty) * c.qty
           end qty ,
           case 
              when fmdi.scale_type = 0 then
                 (((fmdi.qty / fmi.qty) / vri.std_qty) * c.qty_cst) / (1 - (NVL(vri.planned_process_loss,0) / 100))
              when fmdi.scale_type = 1 then
                 ((fmdi.qty / fmi.qty) * c.qty_cst) / (1 - (NVL(vri.planned_process_loss,0) / 100))
              else
                 ((fmdi.qty / fmi.qty) * c.qty_cst) / (1 - (NVL(vri.planned_process_loss,0) / 100))
           end qty_cst ,
           fmdi.formula_id,
           gri.recipe_id,
           fmdi.organization_id,      
           c.nivel + 1
--           
      FROM apps.fm_form_mst_b fmsi
      join apps.fm_matl_dtl   fmi  
        on NVL(fmsi.formula_class,'SM') <> 'TING-PMC' AND
           fmsi.formula_id               = fmi.formula_id
--
      join apps.gmd_recipes_b gri
        on gri.recipe_status        in (700,900)            AND
           gri.recipe_id            = (select max(gr1.recipe_id)
                                         FROM apps.gmd_recipes_b             gr1,
                                              apps.gmd_recipe_validity_rules vr1,
                                              apps.fm_matl_dtl               fmd1
                                        WHERE vr1.delete_mark                 = 0                     AND
                                              --vr1.preference                  = 1                     AND      
                                              vr1.recipe_use                  = 2 /*Custos*/          AND -- 0 = Produção    2 = Custos
                                              vr1.validity_rule_status       in (700,900)             AND
                                              vr1.start_date                 <= sysdate               AND
                                              vr1.end_date                   is NULL                  AND
                                              vr1.organization_id             = fmi.organization_id   AND
                                              vr1.recipe_id                   = gr1.recipe_id         AND
                                              gr1.recipe_status              in (700,900)             AND
                                              fmd1.inventory_item_id          = fmi.inventory_item_id AND
                                              fmd1.line_type                  = 1                     AND
                                              gr1.formula_id                  = fmd1.formula_id)
                                              --gr1.formula_id                  = fmi.formula_id)       
--                   
--
      join apps.gmd_recipe_validity_rules vri
        on /**** performance ****/
           --vri.preference                  = 1                   AND      
           vri.delete_mark                 = 0                   AND
           vri.recipe_use                  = 2                   AND -- 0=Producao   2=Custos 
           vri.validity_rule_status       in (700,900)           AND 
           vri.start_date                 <= sysdate             AND
           NVL(vri.end_date,(SYSDATE + 1)) > sysdate             AND
           vri.organization_id             = fmi.organization_id AND           
           vri.recipe_id                   = gri.recipe_id
           /**** performance ****/
--           
      join apps.fm_matl_dtl fmdi
        on fmdi.line_type           = -1                    AND
           fmdi.formula_id          = fmi.formula_id        AND
           fmdi.formula_id          = gri.formula_id        AND
           fmdi.organization_id     = fmi.organization_id    
--
--           
      join apps.mtl_system_items_b msii
        on fmi.inventory_item_id   = msii.inventory_item_id AND
           fmi.line_type           = 1                      AND
           msii.inventory_item_id  = fmi.inventory_item_id  AND
           msii.organization_id    = fmi.organization_id 
           --
--           
      join  cteMenuNivel c 
        on msii.inventory_item_id = c.inventory_item_id AND
           fmdi.inventory_item_id <> c.inventory_item_id and
           c.nivel                < 20
--
)      
--
--cycle inventory_item_id set is_cycle to '1' default '0'
--
SELECT c.segment1,
      -- c.nivel,
       msi.segment1 Ingrediente,
       msi.primary_uom_code,
       TRANSLATE(TRANSLATE(SUBSTR(MSI.DESCRIPTION,1,180),'ABCDEFGHIJKLMNOPQRSTUWVXYZabcdefghijklmnopqrstuwvxyz01234567890ÑÁÉÍÓÚÀÈÌÒÙÂÊÎÔÛÃÕÄËÏÖÜÇñáéíóúàèìòùâêîôûãõäëïöüçºª²°.-!"''`#$%().:[/]{}¨+???¿;§&´*<>'
                                                       ,'ABCDEFGHIJKLMNOPQRSTUWVXYZabcdefghijklmnopqrstuwvxyz01234567890NAEIOUAEIOUAEIOUAOAEIOUCnaeiouaeiouaeiouaoaeiouc-'),CHR(10),' ') "Descricao",
       msi.item_type,
       --c.formula_id,
       --c.inventory_item_id,
       sum(c.qty),
       sum(c.qty_cst),
       --c.Nivel,
--       
       MSI.GLOBAL_ATTRIBUTE2       "Classe da Cond da Transação",
       MSI.GLOBAL_ATTRIBUTE3       "Origem do Item",
       MSI.GLOBAL_ATTRIBUTE4       "Tipo Fiscal do Item",
--       MSI.GLOBAL_ATTRIBUTE6       "Situação Trib Estadual",
--      MSI.GLOBAL_ATTRIBUTE5       "Situação Trib Federal",
--      MSI.GLOBAL_ATTRIBUTE10      "EAN13",
--       MSI.GLOBAL_ATTRIBUTE16      "Importar Conteudo",
--       MSI.GLOBAL_ATTRIBUTE17      "Valor Parcela estrangeira",
--       MSI.GLOBAL_ATTRIBUTE18      "Valor Total Envio Inter",
--       MSI.GLOBAL_ATTRIBUTE19      "Numero FCI",       
       FISCAL_CLASSIFICATION.CATEGORIA "NCM",
       sum(c.qty_cst) * (select sum(CMPNT_COST) 
                           from apps.cm_cmpt_dtl ccd
                          where inventory_item_id = c.inventory_item_id
                            AND organization_id   = c.organization_id
                            AND cost_type_id      = '1005'
                          --  AND COST_ANALYSIS_CODE = 'MT'
                            AND period_id         = (SELECT MAX(cstt.period_id)
                                                       FROM apps.CM_CMPT_DTL cstt, apps.gmf_period_statuses gps
                                                      WHERE gps.cost_type_id       = cstt.cost_type_id
                                                        AND cstt.period_id         = gps.period_id
                                                        AND cstt.delete_mark       = '0'
                                                        AND cstt.organization_id   = c.organization_id
                                                        AND cstt.inventory_item_id = c.inventory_item_id
                                                        AND cstt.cost_type_id      = '1005'
                                                        AND cmpnt_cost       <> 0)) CUSTO_STD    
--       
--       
--       
  FROM cteMenuNivel c,
       apps.mtl_system_items_b msi,
       (SELECT MIC.INVENTORY_ITEM_ID,
               MIC.ORGANIZATION_ID,
               MIC.CATEGORY_SET_NAME,
               MIC.CATEGORY_CONCAT_SEGS CATEGORIA
          FROM APPS.MTL_ITEM_CATEGORIES_V MIC, APPS.MTL_CATEGORIES_V MC
         WHERE MC.CATEGORY_ID = MIC.CATEGORY_ID
           AND MIC.CATEGORY_SET_NAME IN ('FISCAL_CLASSIFICATION')) FISCAL_CLASSIFICATION
 WHERE msi.inventory_item_id      = c.inventory_item_id AND
       msi.organization_id        = c.organization_id   AND
       msi.planning_make_buy_code = 2                   AND
       --msi.primary_uom_code       = 'kg' AND
     --  msi.item_type             <> 'INS/EMB'           AND
     --  msi.item_type             <> 'MISC'           AND
       MSI.ORGANIZATION_ID        = FISCAL_CLASSIFICATION.ORGANIZATION_ID(+) AND
       MSI.INVENTORY_ITEM_ID      = FISCAL_CLASSIFICATION.INVENTORY_ITEM_ID(+)
   --    and msi.PRIMARY_UOM_CODE = 'kg' and msi.ITEM_TYPE = 'MP'
  group by c.segment1,
         --  c.nivel,
           msi.segment1,
           msi.primary_uom_code,
           msi.item_type,
           MSI.GLOBAL_ATTRIBUTE2,
           MSI.GLOBAL_ATTRIBUTE3,
           MSI.GLOBAL_ATTRIBUTE4,
           FISCAL_CLASSIFICATION.CATEGORIA,
           MSI.DESCRIPTION,
           c.inventory_item_id,
           c.organization_id
  order by 1,2,3
       ;

select * from apps.mtl_system_items_b where segment1 in ('SRC-75','HE-15-8633');

XXPPG_PF_INGREDIENTE